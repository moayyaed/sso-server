2019-12-30 17:40:33.090 +07:00 [INF] Starting IdentityServer4 version 2.4.0.0
2019-12-30 17:40:33.223 +07:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-12-30 17:40:33.223 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-12-30 17:40:33.223 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-12-30 17:40:33.223 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-12-30 17:40:33.223 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-12-30 17:40:33.224 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-12-30 17:40:33.531 +07:00 [DBG] Starting grant removal
2019-12-30 17:41:04.102 +07:00 [INF] Removing 0 grants
2019-12-30 17:41:34.117 +07:00 [INF] Removing 0 grants
2019-12-30 17:42:04.128 +07:00 [INF] Removing 0 grants
2019-12-30 17:42:34.132 +07:00 [INF] Removing 0 grants
2019-12-30 17:43:04.144 +07:00 [INF] Removing 0 grants
2019-12-30 17:43:26.695 +07:00 [WRN] Failed to determine the https port for redirect.
2019-12-30 17:43:26.710 +07:00 [DBG] CORS request made for path: /api/account from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-12-30 17:43:26.728 +07:00 [DBG] Login Url: /Account/Login
2019-12-30 17:43:26.728 +07:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-12-30 17:43:26.728 +07:00 [DBG] Logout Url: /Account/Logout
2019-12-30 17:43:26.728 +07:00 [DBG] ConsentUrl Url: /consent
2019-12-30 17:43:26.728 +07:00 [DBG] Consent Return Url Parameter: returnUrl
2019-12-30 17:43:26.728 +07:00 [DBG] Error Url: /home/error
2019-12-30 17:43:26.728 +07:00 [DBG] Error Id Parameter: errorId
2019-12-30 17:43:34.146 +07:00 [INF] Removing 0 grants
2019-12-30 17:43:41.053 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 17:43:41.057 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 17:43:41.057 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 17:43:41.059 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 17:43:41.063 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 17:43:41.063 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 17:43:41.069 +07:00 [DBG] Start discovery request
2019-12-30 17:43:41.140 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 17:43:41.144 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 17:43:41.145 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 17:43:41.149 +07:00 [DBG] Start authorize request
2019-12-30 17:43:41.160 +07:00 [DBG] No user present in authorize request
2019-12-30 17:43:41.165 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 17:43:41.190 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 17:43:41.232 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 17:43:41.257 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"b15bd41b215f4be5b87c888eb216e9e9","UiLocales":null,"Nonce":"fa362798fd634e04a2a32db3be94a8d3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"b15bd41b215f4be5b87c888eb216e9e9","nonce":"fa362798fd634e04a2a32db3be94a8d3"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 17:43:41.274 +07:00 [INF] Showing login: User is not authenticated
2019-12-30 17:43:41.317 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 17:43:41.317 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 17:43:41.318 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 17:43:41.321 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 17:43:53.217 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 17:43:53.217 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 17:43:53.217 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 17:43:53.264 +07:00 [DBG] Augmenting SignInContext
2019-12-30 17:43:53.267 +07:00 [DBG] Adding idp claim with value: local
2019-12-30 17:43:53.267 +07:00 [DBG] Adding amr claim with value: pwd
2019-12-30 17:43:53.281 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 17:43:53.292 +07:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-12-30 17:43:53.293 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-12-30 17:43:53.294 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-12-30 17:43:53.300 +07:00 [DBG] Start authorize callback request
2019-12-30 17:43:53.305 +07:00 [DBG] User in authorize request: e2f360c0-3784-489a-ab74-b85654db43d8
2019-12-30 17:43:53.305 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 17:43:53.305 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 17:43:53.305 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 17:43:53.306 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"e2f360c0-3784-489a-ab74-b85654db43d8","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"b15bd41b215f4be5b87c888eb216e9e9","UiLocales":null,"Nonce":"fa362798fd634e04a2a32db3be94a8d3","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"3bec9888bd4be5bb742351054eeaa639","Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"b15bd41b215f4be5b87c888eb216e9e9","nonce":"fa362798fd634e04a2a32db3be94a8d3"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 17:43:53.339 +07:00 [DBG] Client is configured to not require consent, no consent is required
2019-12-30 17:43:53.348 +07:00 [DBG] Creating Implicit Flow response.
2019-12-30 17:43:53.369 +07:00 [DBG] Getting claims for access token for client: angular_spa
2019-12-30 17:43:53.370 +07:00 [DBG] Getting claims for access token for subject: e2f360c0-3784-489a-ab74-b85654db43d8
2019-12-30 17:43:53.586 +07:00 [DBG] Getting claims for identity token for subject: e2f360c0-3784-489a-ab74-b85654db43d8 and client: angular_spa
2019-12-30 17:43:53.586 +07:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-12-30 17:43:53.602 +07:00 [INF] Authorize endpoint response
{"SubjectId":"e2f360c0-3784-489a-ab74-b85654db43d8","ClientId":"angular_spa","RedirectUri":"http://localhost:4200/auth-callback","State":"b15bd41b215f4be5b87c888eb216e9e9","Scope":"openid profile email api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-12-30 17:43:53.621 +07:00 [DBG] Augmenting SignInContext
2019-12-30 17:43:54.567 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 17:43:54.567 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 17:43:54.567 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 17:43:54.567 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 17:43:54.567 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 17:43:54.567 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 17:43:54.567 +07:00 [DBG] Start discovery request
2019-12-30 17:43:54.626 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-12-30 17:43:54.626 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 17:43:54.626 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 17:43:54.627 +07:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-12-30 17:43:54.628 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-12-30 17:43:54.628 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-12-30 17:43:54.639 +07:00 [DBG] Start key discovery request
2019-12-30 17:43:54.722 +07:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-12-30 17:43:54.723 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 17:43:54.723 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 17:43:54.727 +07:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-12-30 17:43:54.730 +07:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-12-30 17:43:54.731 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-12-30 17:43:54.737 +07:00 [DBG] Start userinfo request
2019-12-30 17:43:54.741 +07:00 [DBG] Bearer token found in header
2019-12-30 17:43:54.781 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 17:43:54.784 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 17:43:54.789 +07:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-12-30 17:43:54.793 +07:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1577702633,"exp":1577706233,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourceapi"],"client_id":"angular_spa","sub":"e2f360c0-3784-489a-ab74-b85654db43d8","auth_time":1577702633,"idp":"local","given_name":"Chu Sỹ Duy","email":"duycs@outlook.com","http://schemas.microsoft.com/ws/2008/06/identity/claims/role":"consumer","scope":["openid","profile","email","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-12-30 17:43:54.805 +07:00 [DBG] Creating userinfo response
2019-12-30 17:43:54.810 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 17:43:54.814 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 17:43:54.818 +07:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-12-30 17:43:54.818 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 17:43:54.830 +07:00 [INF] Profile service returned the following claim types: sub name email preferred_username email email_verified given_name email http://schemas.microsoft.com/ws/2008/06/identity/claims/role
2019-12-30 17:43:54.831 +07:00 [DBG] End userinfo request
2019-12-30 17:43:54.872 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 17:43:54.872 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 17:43:54.873 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 17:43:54.874 +07:00 [DBG] Rendering check session result
2019-12-30 17:44:04.161 +07:00 [INF] Removing 0 grants
2019-12-30 17:44:34.162 +07:00 [INF] Removing 0 grants
2019-12-30 17:45:04.178 +07:00 [INF] Removing 0 grants
2019-12-30 17:45:34.192 +07:00 [INF] Removing 0 grants
2019-12-30 17:46:02.981 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 17:46:02.982 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 17:46:02.982 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 17:46:02.982 +07:00 [DBG] Start discovery request
2019-12-30 17:46:03.095 +07:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-12-30 17:46:03.096 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-12-30 17:46:03.096 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-12-30 17:46:03.096 +07:00 [DBG] Start key discovery request
2019-12-30 17:46:04.207 +07:00 [INF] Removing 0 grants
2019-12-30 17:46:34.228 +07:00 [INF] Removing 0 grants
2019-12-30 17:47:04.242 +07:00 [INF] Removing 0 grants
2019-12-30 17:47:34.255 +07:00 [INF] Removing 0 grants
2019-12-30 17:47:44.903 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 17:47:44.903 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 17:47:44.903 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 17:47:44.903 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 17:47:44.903 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 17:47:44.903 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 17:47:44.903 +07:00 [DBG] Start discovery request
2019-12-30 17:47:45.003 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 17:47:45.003 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 17:47:45.003 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 17:47:45.003 +07:00 [DBG] Rendering check session result
2019-12-30 17:47:46.772 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 17:47:46.773 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 17:47:46.773 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 17:47:46.773 +07:00 [DBG] Start authorize request
2019-12-30 17:47:46.774 +07:00 [DBG] User in authorize request: e2f360c0-3784-489a-ab74-b85654db43d8
2019-12-30 17:47:46.774 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 17:47:46.774 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 17:47:46.774 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 17:47:46.774 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"e2f360c0-3784-489a-ab74-b85654db43d8","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"08c9dde306b345109d25f410740abffc","UiLocales":null,"Nonce":"aa8c2a009e8d4b5a9e5c5163e8e38acd","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"3bec9888bd4be5bb742351054eeaa639","Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"08c9dde306b345109d25f410740abffc","nonce":"aa8c2a009e8d4b5a9e5c5163e8e38acd"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 17:47:46.778 +07:00 [DBG] Client is configured to not require consent, no consent is required
2019-12-30 17:47:46.778 +07:00 [DBG] Creating Implicit Flow response.
2019-12-30 17:47:46.778 +07:00 [DBG] Getting claims for access token for client: angular_spa
2019-12-30 17:47:46.778 +07:00 [DBG] Getting claims for access token for subject: e2f360c0-3784-489a-ab74-b85654db43d8
2019-12-30 17:47:46.791 +07:00 [DBG] Getting claims for identity token for subject: e2f360c0-3784-489a-ab74-b85654db43d8 and client: angular_spa
2019-12-30 17:47:46.791 +07:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-12-30 17:47:46.795 +07:00 [INF] Authorize endpoint response
{"SubjectId":"e2f360c0-3784-489a-ab74-b85654db43d8","ClientId":"angular_spa","RedirectUri":"http://localhost:4200/auth-callback","State":"08c9dde306b345109d25f410740abffc","Scope":"openid profile email api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-12-30 17:47:47.557 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 17:47:47.558 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 17:47:47.558 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 17:47:47.558 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 17:47:47.558 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 17:47:47.558 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 17:47:47.558 +07:00 [DBG] Start discovery request
2019-12-30 17:47:47.564 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 17:47:47.565 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 17:47:47.565 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 17:47:47.565 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 17:47:47.565 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 17:47:47.566 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 17:47:47.574 +07:00 [DBG] Start discovery request
2019-12-30 17:47:47.589 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 17:47:47.589 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 17:47:47.589 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 17:47:47.589 +07:00 [DBG] Rendering check session result
2019-12-30 17:47:47.601 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-12-30 17:47:47.602 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 17:47:47.602 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 17:47:47.602 +07:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-12-30 17:47:47.602 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-12-30 17:47:47.602 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-12-30 17:47:47.602 +07:00 [DBG] Start key discovery request
2019-12-30 17:47:47.673 +07:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-12-30 17:47:47.673 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 17:47:47.673 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 17:47:47.673 +07:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-12-30 17:47:47.674 +07:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-12-30 17:47:47.676 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-12-30 17:47:47.676 +07:00 [DBG] Start userinfo request
2019-12-30 17:47:47.676 +07:00 [DBG] Bearer token found in header
2019-12-30 17:47:47.688 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 17:47:47.689 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 17:47:47.693 +07:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-12-30 17:47:47.694 +07:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1577702866,"exp":1577706466,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourceapi"],"client_id":"angular_spa","sub":"e2f360c0-3784-489a-ab74-b85654db43d8","auth_time":1577702633,"idp":"local","given_name":"Chu Sỹ Duy","email":"duycs@outlook.com","http://schemas.microsoft.com/ws/2008/06/identity/claims/role":"consumer","scope":["openid","profile","email","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-12-30 17:47:47.694 +07:00 [DBG] Creating userinfo response
2019-12-30 17:47:47.694 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 17:47:47.694 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 17:47:47.694 +07:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-12-30 17:47:47.694 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 17:47:47.697 +07:00 [INF] Profile service returned the following claim types: sub name email preferred_username email email_verified given_name email http://schemas.microsoft.com/ws/2008/06/identity/claims/role
2019-12-30 17:47:47.697 +07:00 [DBG] End userinfo request
2019-12-30 17:48:04.273 +07:00 [INF] Removing 0 grants
2019-12-30 17:48:34.285 +07:00 [INF] Removing 0 grants
2019-12-30 17:49:04.291 +07:00 [INF] Removing 0 grants
2019-12-30 17:49:34.302 +07:00 [INF] Removing 0 grants
2019-12-30 17:50:04.304 +07:00 [INF] Removing 0 grants
2019-12-30 17:50:34.322 +07:00 [INF] Removing 0 grants
2019-12-30 17:51:04.331 +07:00 [INF] Removing 0 grants
2019-12-30 17:51:10.429 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 17:51:10.429 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 17:51:10.430 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 17:51:10.430 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 17:51:10.430 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 17:51:10.430 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 17:51:10.430 +07:00 [DBG] Start discovery request
2019-12-30 17:51:10.482 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 17:51:10.483 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 17:51:10.483 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 17:51:10.483 +07:00 [DBG] Rendering check session result
2019-12-30 17:51:11.819 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 17:51:11.819 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 17:51:11.819 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 17:51:11.819 +07:00 [DBG] Start authorize request
2019-12-30 17:51:11.820 +07:00 [DBG] User in authorize request: e2f360c0-3784-489a-ab74-b85654db43d8
2019-12-30 17:51:11.820 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 17:51:11.820 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 17:51:11.822 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 17:51:11.824 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"e2f360c0-3784-489a-ab74-b85654db43d8","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"70d116cf812142b8b5451567ff3c10c7","UiLocales":null,"Nonce":"ff864b5fff6543de913dd734aac7ae9b","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"3bec9888bd4be5bb742351054eeaa639","Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"70d116cf812142b8b5451567ff3c10c7","nonce":"ff864b5fff6543de913dd734aac7ae9b"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 17:51:11.828 +07:00 [DBG] Client is configured to not require consent, no consent is required
2019-12-30 17:51:11.828 +07:00 [DBG] Creating Implicit Flow response.
2019-12-30 17:51:11.828 +07:00 [DBG] Getting claims for access token for client: angular_spa
2019-12-30 17:51:11.828 +07:00 [DBG] Getting claims for access token for subject: e2f360c0-3784-489a-ab74-b85654db43d8
2019-12-30 17:51:11.839 +07:00 [DBG] Getting claims for identity token for subject: e2f360c0-3784-489a-ab74-b85654db43d8 and client: angular_spa
2019-12-30 17:51:11.840 +07:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-12-30 17:51:11.843 +07:00 [INF] Authorize endpoint response
{"SubjectId":"e2f360c0-3784-489a-ab74-b85654db43d8","ClientId":"angular_spa","RedirectUri":"http://localhost:4200/auth-callback","State":"70d116cf812142b8b5451567ff3c10c7","Scope":"openid profile email api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-12-30 17:51:12.414 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 17:51:12.414 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 17:51:12.414 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 17:51:12.414 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 17:51:12.414 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 17:51:12.414 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 17:51:12.414 +07:00 [DBG] Start discovery request
2019-12-30 17:51:12.427 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 17:51:12.427 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 17:51:12.427 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 17:51:12.428 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 17:51:12.428 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 17:51:12.428 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 17:51:12.428 +07:00 [DBG] Start discovery request
2019-12-30 17:51:12.455 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 17:51:12.456 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 17:51:12.456 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 17:51:12.456 +07:00 [DBG] Rendering check session result
2019-12-30 17:51:12.459 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-12-30 17:51:12.460 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 17:51:12.460 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 17:51:12.460 +07:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-12-30 17:51:12.462 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-12-30 17:51:12.462 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-12-30 17:51:12.463 +07:00 [DBG] Start key discovery request
2019-12-30 17:51:12.497 +07:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-12-30 17:51:12.497 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 17:51:12.497 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 17:51:12.498 +07:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-12-30 17:51:12.498 +07:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-12-30 17:51:12.498 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-12-30 17:51:12.498 +07:00 [DBG] Start userinfo request
2019-12-30 17:51:12.498 +07:00 [DBG] Bearer token found in header
2019-12-30 17:51:12.500 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 17:51:12.500 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 17:51:12.502 +07:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-12-30 17:51:12.502 +07:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1577703071,"exp":1577706671,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourceapi"],"client_id":"angular_spa","sub":"e2f360c0-3784-489a-ab74-b85654db43d8","auth_time":1577702633,"idp":"local","given_name":"Chu Sỹ Duy","email":"duycs@outlook.com","http://schemas.microsoft.com/ws/2008/06/identity/claims/role":"consumer","scope":["openid","profile","email","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-12-30 17:51:12.502 +07:00 [DBG] Creating userinfo response
2019-12-30 17:51:12.503 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 17:51:12.503 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 17:51:12.503 +07:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-12-30 17:51:12.503 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 17:51:12.505 +07:00 [INF] Profile service returned the following claim types: sub name email preferred_username email email_verified given_name email http://schemas.microsoft.com/ws/2008/06/identity/claims/role
2019-12-30 17:51:12.505 +07:00 [DBG] End userinfo request
2019-12-30 17:51:13.412 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 17:51:13.413 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 17:51:13.413 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 17:51:13.413 +07:00 [DBG] Start discovery request
2019-12-30 17:51:13.494 +07:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-12-30 17:51:13.494 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-12-30 17:51:13.494 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-12-30 17:51:13.494 +07:00 [DBG] Start key discovery request
2019-12-30 17:51:34.349 +07:00 [INF] Removing 0 grants
2019-12-30 17:51:51.648 +07:00 [DBG] TaskCanceledException. Exiting.
2019-12-30 17:51:51.663 +07:00 [DBG] Stopping grant removal
2019-12-30 17:52:04.746 +07:00 [INF] Starting IdentityServer4 version 2.4.0.0
2019-12-30 17:52:04.836 +07:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-12-30 17:52:04.836 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-12-30 17:52:04.836 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-12-30 17:52:04.836 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-12-30 17:52:04.836 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-12-30 17:52:04.836 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-12-30 17:52:04.976 +07:00 [DBG] Starting grant removal
2019-12-30 17:52:29.040 +07:00 [WRN] Failed to determine the https port for redirect.
2019-12-30 17:52:29.052 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 17:52:29.056 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 17:52:29.056 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 17:52:29.071 +07:00 [DBG] Login Url: /Account/Login
2019-12-30 17:52:29.071 +07:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-12-30 17:52:29.071 +07:00 [DBG] Logout Url: /Account/Logout
2019-12-30 17:52:29.071 +07:00 [DBG] ConsentUrl Url: /consent
2019-12-30 17:52:29.071 +07:00 [DBG] Consent Return Url Parameter: returnUrl
2019-12-30 17:52:29.071 +07:00 [DBG] Error Url: /home/error
2019-12-30 17:52:29.071 +07:00 [DBG] Error Id Parameter: errorId
2019-12-30 17:52:29.100 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 17:52:29.115 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 17:52:29.115 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 17:52:29.118 +07:00 [DBG] Start discovery request
2019-12-30 17:52:29.182 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 17:52:29.183 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 17:52:29.183 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 17:52:29.184 +07:00 [DBG] Rendering check session result
2019-12-30 17:52:35.250 +07:00 [INF] Removing 0 grants
2019-12-30 17:53:05.256 +07:00 [INF] Removing 0 grants
2019-12-30 17:53:35.271 +07:00 [INF] Removing 0 grants
2019-12-30 17:54:05.285 +07:00 [INF] Removing 0 grants
2019-12-30 17:54:35.303 +07:00 [INF] Removing 0 grants
2019-12-30 17:55:05.317 +07:00 [INF] Removing 0 grants
2019-12-30 17:55:35.331 +07:00 [INF] Removing 0 grants
2019-12-30 17:56:05.350 +07:00 [INF] Removing 0 grants
2019-12-30 17:56:35.366 +07:00 [INF] Removing 0 grants
2019-12-30 17:57:05.379 +07:00 [INF] Removing 0 grants
2019-12-30 17:57:35.394 +07:00 [INF] Removing 0 grants
2019-12-30 17:58:05.398 +07:00 [INF] Removing 0 grants
2019-12-30 17:58:35.413 +07:00 [INF] Removing 0 grants
2019-12-30 17:59:05.427 +07:00 [INF] Removing 0 grants
2019-12-30 17:59:35.429 +07:00 [INF] Removing 0 grants
2019-12-30 18:00:05.448 +07:00 [INF] Removing 0 grants
2019-12-30 18:00:35.494 +07:00 [INF] Removing 0 grants
2019-12-30 18:01:05.504 +07:00 [INF] Removing 0 grants
2019-12-30 18:01:35.507 +07:00 [INF] Removing 0 grants
2019-12-30 18:02:05.520 +07:00 [INF] Removing 0 grants
2019-12-30 18:02:35.525 +07:00 [INF] Removing 0 grants
2019-12-30 18:03:05.536 +07:00 [INF] Removing 0 grants
2019-12-30 18:03:35.552 +07:00 [INF] Removing 0 grants
2019-12-30 18:04:05.565 +07:00 [INF] Removing 0 grants
2019-12-30 18:04:35.571 +07:00 [INF] Removing 0 grants
2019-12-30 18:05:05.572 +07:00 [INF] Removing 0 grants
2019-12-30 18:05:35.588 +07:00 [INF] Removing 0 grants
2019-12-30 18:06:05.597 +07:00 [INF] Removing 0 grants
2019-12-30 18:06:35.613 +07:00 [INF] Removing 0 grants
2019-12-30 18:07:05.616 +07:00 [INF] Removing 0 grants
2019-12-30 18:07:35.655 +07:00 [INF] Removing 0 grants
2019-12-30 18:08:05.657 +07:00 [INF] Removing 0 grants
2019-12-30 18:08:35.668 +07:00 [INF] Removing 0 grants
2019-12-30 18:09:05.671 +07:00 [INF] Removing 0 grants
2019-12-30 18:09:35.678 +07:00 [INF] Removing 0 grants
2019-12-30 18:10:05.693 +07:00 [INF] Removing 0 grants
2019-12-30 18:10:35.707 +07:00 [INF] Removing 0 grants
2019-12-30 18:11:05.711 +07:00 [INF] Removing 0 grants
2019-12-30 18:11:35.722 +07:00 [INF] Removing 0 grants
2019-12-30 18:12:05.773 +07:00 [INF] Removing 0 grants
2019-12-30 18:12:35.790 +07:00 [INF] Removing 0 grants
2019-12-30 18:13:05.806 +07:00 [INF] Removing 0 grants
2019-12-30 18:13:35.815 +07:00 [INF] Removing 0 grants
2019-12-30 18:14:05.816 +07:00 [INF] Removing 0 grants
2019-12-30 18:14:35.820 +07:00 [INF] Removing 0 grants
2019-12-30 18:15:05.832 +07:00 [INF] Removing 0 grants
2019-12-30 18:15:35.848 +07:00 [INF] Removing 0 grants
2019-12-30 18:16:05.848 +07:00 [INF] Removing 0 grants
2019-12-30 18:16:35.864 +07:00 [INF] Removing 0 grants
2019-12-30 18:17:05.867 +07:00 [INF] Removing 0 grants
2019-12-30 18:17:35.885 +07:00 [INF] Removing 0 grants
2019-12-30 18:17:39.637 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 18:17:39.637 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 18:17:39.637 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 18:17:39.638 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 18:17:39.638 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 18:17:39.638 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 18:17:39.638 +07:00 [DBG] Start discovery request
2019-12-30 18:17:39.864 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 18:17:39.869 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 18:17:39.869 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 18:17:39.873 +07:00 [DBG] Start authorize request
2019-12-30 18:17:39.881 +07:00 [DBG] No user present in authorize request
2019-12-30 18:17:39.885 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 18:17:39.902 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 18:17:39.938 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 18:17:39.960 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"ba2943532ed148e49a1eaeaede99bf20","UiLocales":null,"Nonce":"fa9c03d3e1ac48aa94bff13f0cd63090","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"ba2943532ed148e49a1eaeaede99bf20","nonce":"fa9c03d3e1ac48aa94bff13f0cd63090"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 18:17:39.970 +07:00 [INF] Showing login: User is not authenticated
2019-12-30 18:17:40.071 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 18:17:40.071 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 18:17:40.071 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 18:17:40.073 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 18:17:54.832 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 18:17:54.832 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 18:17:54.833 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 18:17:54.850 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 18:17:54.854 +07:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-12-30 18:17:54.855 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-12-30 18:17:54.855 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-12-30 18:17:54.865 +07:00 [DBG] Start authorize callback request
2019-12-30 18:17:54.870 +07:00 [DBG] No user present in authorize request
2019-12-30 18:17:54.870 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 18:17:54.870 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 18:17:54.870 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 18:17:54.870 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"ba2943532ed148e49a1eaeaede99bf20","UiLocales":null,"Nonce":"fa9c03d3e1ac48aa94bff13f0cd63090","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"ba2943532ed148e49a1eaeaede99bf20","nonce":"fa9c03d3e1ac48aa94bff13f0cd63090"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 18:17:54.870 +07:00 [INF] Error: User denied consent
2019-12-30 18:17:54.873 +07:00 [INF] {"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"ba2943532ed148e49a1eaeaede99bf20","UiLocales":null,"Nonce":"fa9c03d3e1ac48aa94bff13f0cd63090","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"ba2943532ed148e49a1eaeaede99bf20","nonce":"fa9c03d3e1ac48aa94bff13f0cd63090"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 18:18:05.900 +07:00 [INF] Removing 0 grants
2019-12-30 18:18:35.915 +07:00 [INF] Removing 0 grants
2019-12-30 18:19:05.927 +07:00 [INF] Removing 0 grants
2019-12-30 18:19:35.941 +07:00 [INF] Removing 0 grants
2019-12-30 18:20:05.946 +07:00 [INF] Removing 0 grants
2019-12-30 18:20:35.956 +07:00 [INF] Removing 0 grants
2019-12-30 18:20:54.788 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 18:20:54.788 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 18:20:54.788 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 18:20:54.788 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 18:20:54.788 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 18:20:54.788 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 18:20:54.788 +07:00 [DBG] Start discovery request
2019-12-30 18:20:54.802 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 18:20:54.803 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 18:20:54.803 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 18:20:54.803 +07:00 [DBG] Start authorize request
2019-12-30 18:20:54.803 +07:00 [DBG] No user present in authorize request
2019-12-30 18:20:54.803 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 18:20:54.804 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 18:20:54.804 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 18:20:54.804 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"dee165d1c2074619baada56288117ddb","UiLocales":null,"Nonce":"3f64eefe249e465184fdcddeee9feae5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"dee165d1c2074619baada56288117ddb","nonce":"3f64eefe249e465184fdcddeee9feae5"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 18:20:54.804 +07:00 [INF] Showing login: User is not authenticated
2019-12-30 18:20:54.808 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 18:20:54.808 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 18:20:54.809 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 18:20:54.809 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 18:20:57.060 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 18:20:57.060 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 18:20:57.060 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 18:20:57.060 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 18:20:57.064 +07:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-12-30 18:20:57.066 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-12-30 18:20:57.066 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-12-30 18:20:57.066 +07:00 [DBG] Start authorize callback request
2019-12-30 18:20:57.067 +07:00 [DBG] No user present in authorize request
2019-12-30 18:20:57.067 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 18:20:57.067 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 18:20:57.067 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 18:20:57.068 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"dee165d1c2074619baada56288117ddb","UiLocales":null,"Nonce":"3f64eefe249e465184fdcddeee9feae5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"dee165d1c2074619baada56288117ddb","nonce":"3f64eefe249e465184fdcddeee9feae5"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 18:20:57.068 +07:00 [INF] Error: User denied consent
2019-12-30 18:20:57.068 +07:00 [INF] {"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"dee165d1c2074619baada56288117ddb","UiLocales":null,"Nonce":"3f64eefe249e465184fdcddeee9feae5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"dee165d1c2074619baada56288117ddb","nonce":"3f64eefe249e465184fdcddeee9feae5"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 18:21:00.416 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 18:21:00.416 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 18:21:00.417 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 18:21:00.417 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 18:21:00.418 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 18:21:00.418 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 18:21:00.418 +07:00 [DBG] Start discovery request
2019-12-30 18:21:00.431 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 18:21:00.431 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 18:21:00.431 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 18:21:00.431 +07:00 [DBG] Start authorize request
2019-12-30 18:21:00.431 +07:00 [DBG] No user present in authorize request
2019-12-30 18:21:00.431 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 18:21:00.432 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 18:21:00.432 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 18:21:00.432 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"b2c364d740614ce8a9e26c8e25605720","UiLocales":null,"Nonce":"16e9251900da41da840f1dfba72d328c","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"b2c364d740614ce8a9e26c8e25605720","nonce":"16e9251900da41da840f1dfba72d328c"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 18:21:00.432 +07:00 [INF] Showing login: User is not authenticated
2019-12-30 18:21:00.438 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 18:21:00.438 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 18:21:00.438 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 18:21:00.438 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 18:21:05.974 +07:00 [INF] Removing 0 grants
2019-12-30 18:21:35.989 +07:00 [INF] Removing 0 grants
2019-12-30 18:22:05.993 +07:00 [INF] Removing 0 grants
2019-12-30 18:22:36.004 +07:00 [INF] Removing 0 grants
2019-12-30 18:22:36.428 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 18:22:36.428 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 18:22:36.428 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 18:22:36.429 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 18:22:57.906 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 18:22:57.906 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 18:22:57.906 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 18:22:57.906 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 18:23:06.006 +07:00 [INF] Removing 0 grants
2019-12-30 18:23:36.014 +07:00 [INF] Removing 0 grants
2019-12-30 18:24:06.019 +07:00 [INF] Removing 0 grants
2019-12-30 18:24:36.035 +07:00 [INF] Removing 0 grants
2019-12-30 18:25:06.051 +07:00 [INF] Removing 0 grants
2019-12-30 18:25:36.066 +07:00 [INF] Removing 0 grants
2019-12-30 18:26:06.068 +07:00 [INF] Removing 0 grants
2019-12-30 18:26:36.085 +07:00 [INF] Removing 0 grants
2019-12-30 18:27:06.097 +07:00 [INF] Removing 0 grants
2019-12-30 18:27:36.115 +07:00 [INF] Removing 0 grants
2019-12-30 18:28:06.129 +07:00 [INF] Removing 0 grants
2019-12-30 18:28:36.134 +07:00 [INF] Removing 0 grants
2019-12-30 18:29:06.144 +07:00 [INF] Removing 0 grants
2019-12-30 18:29:36.148 +07:00 [INF] Removing 0 grants
2019-12-30 18:30:06.164 +07:00 [INF] Removing 0 grants
2019-12-30 18:30:36.176 +07:00 [INF] Removing 0 grants
2019-12-30 18:31:06.192 +07:00 [INF] Removing 0 grants
2019-12-30 18:31:36.193 +07:00 [INF] Removing 0 grants
2019-12-30 18:32:06.206 +07:00 [INF] Removing 0 grants
2019-12-30 18:32:36.211 +07:00 [INF] Removing 0 grants
2019-12-30 18:33:06.225 +07:00 [INF] Removing 0 grants
2019-12-30 18:33:36.237 +07:00 [INF] Removing 0 grants
2019-12-30 18:34:06.255 +07:00 [INF] Removing 0 grants
2019-12-30 18:34:36.271 +07:00 [INF] Removing 0 grants
2019-12-30 18:35:06.285 +07:00 [INF] Removing 0 grants
2019-12-30 18:35:36.285 +07:00 [INF] Removing 0 grants
2019-12-30 18:36:06.302 +07:00 [INF] Removing 0 grants
2019-12-30 18:36:36.309 +07:00 [INF] Removing 0 grants
2019-12-30 18:37:06.314 +07:00 [INF] Removing 0 grants
2019-12-30 18:37:36.330 +07:00 [INF] Removing 0 grants
2019-12-30 18:38:06.333 +07:00 [INF] Removing 0 grants
2019-12-30 18:38:36.477 +07:00 [INF] Removing 0 grants
2019-12-30 18:39:06.492 +07:00 [INF] Removing 0 grants
2019-12-30 18:39:36.508 +07:00 [INF] Removing 0 grants
2019-12-30 18:40:06.525 +07:00 [INF] Removing 0 grants
2019-12-30 18:40:36.536 +07:00 [INF] Removing 0 grants
2019-12-30 18:41:06.552 +07:00 [INF] Removing 0 grants
2019-12-30 18:41:36.566 +07:00 [INF] Removing 0 grants
2019-12-30 18:42:06.570 +07:00 [INF] Removing 0 grants
2019-12-30 18:42:36.586 +07:00 [INF] Removing 0 grants
2019-12-30 18:43:06.603 +07:00 [INF] Removing 0 grants
2019-12-30 18:43:36.613 +07:00 [INF] Removing 0 grants
2019-12-30 18:44:06.629 +07:00 [INF] Removing 0 grants
2019-12-30 18:44:36.632 +07:00 [INF] Removing 0 grants
2019-12-30 18:45:06.646 +07:00 [INF] Removing 0 grants
2019-12-30 18:45:36.659 +07:00 [INF] Removing 0 grants
2019-12-30 18:46:06.663 +07:00 [INF] Removing 0 grants
2019-12-30 18:46:36.677 +07:00 [INF] Removing 0 grants
2019-12-30 18:47:06.680 +07:00 [INF] Removing 0 grants
2019-12-30 18:47:36.695 +07:00 [INF] Removing 0 grants
2019-12-30 18:48:06.713 +07:00 [INF] Removing 0 grants
2019-12-30 18:48:36.741 +07:00 [INF] Removing 0 grants
2019-12-30 18:49:06.754 +07:00 [INF] Removing 0 grants
2019-12-30 18:49:36.755 +07:00 [INF] Removing 0 grants
2019-12-30 18:50:06.768 +07:00 [INF] Removing 0 grants
2019-12-30 18:50:36.771 +07:00 [INF] Removing 0 grants
2019-12-30 18:51:06.772 +07:00 [INF] Removing 0 grants
2019-12-30 18:51:36.789 +07:00 [INF] Removing 0 grants
2019-12-30 18:52:06.804 +07:00 [INF] Removing 0 grants
2019-12-30 18:52:36.820 +07:00 [INF] Removing 0 grants
2019-12-30 18:53:06.836 +07:00 [INF] Removing 0 grants
2019-12-30 18:53:36.850 +07:00 [INF] Removing 0 grants
2019-12-30 18:54:06.916 +07:00 [INF] Removing 0 grants
2019-12-30 18:54:36.917 +07:00 [INF] Removing 0 grants
2019-12-30 18:55:06.924 +07:00 [INF] Removing 0 grants
2019-12-30 18:55:36.940 +07:00 [INF] Removing 0 grants
2019-12-30 18:56:06.952 +07:00 [INF] Removing 0 grants
2019-12-30 18:56:36.966 +07:00 [INF] Removing 0 grants
2019-12-30 18:57:06.982 +07:00 [INF] Removing 0 grants
2019-12-30 18:57:36.993 +07:00 [INF] Removing 0 grants
2019-12-30 18:58:07.008 +07:00 [INF] Removing 0 grants
2019-12-30 18:58:37.018 +07:00 [INF] Removing 0 grants
2019-12-30 18:59:07.028 +07:00 [INF] Removing 0 grants
2019-12-30 18:59:37.045 +07:00 [INF] Removing 0 grants
2019-12-30 19:00:07.059 +07:00 [INF] Removing 0 grants
2019-12-30 19:00:37.067 +07:00 [INF] Removing 0 grants
2019-12-30 19:01:07.082 +07:00 [INF] Removing 0 grants
2019-12-30 19:01:37.099 +07:00 [INF] Removing 0 grants
2019-12-30 19:02:07.113 +07:00 [INF] Removing 0 grants
2019-12-30 19:02:37.148 +07:00 [INF] Removing 0 grants
2019-12-30 19:03:07.162 +07:00 [INF] Removing 0 grants
2019-12-30 19:03:37.179 +07:00 [INF] Removing 0 grants
2019-12-30 19:04:07.194 +07:00 [INF] Removing 0 grants
2019-12-30 19:04:37.207 +07:00 [INF] Removing 0 grants
2019-12-30 19:05:07.222 +07:00 [INF] Removing 0 grants
2019-12-30 19:05:37.238 +07:00 [INF] Removing 0 grants
2019-12-30 19:06:07.256 +07:00 [INF] Removing 0 grants
2019-12-30 19:06:37.269 +07:00 [INF] Removing 0 grants
2019-12-30 19:07:07.272 +07:00 [INF] Removing 0 grants
2019-12-30 19:07:37.283 +07:00 [INF] Removing 0 grants
2019-12-30 19:08:07.286 +07:00 [INF] Removing 0 grants
2019-12-30 19:08:37.301 +07:00 [INF] Removing 0 grants
2019-12-30 19:09:07.319 +07:00 [INF] Removing 0 grants
2019-12-30 19:09:37.329 +07:00 [INF] Removing 0 grants
2019-12-30 19:10:07.357 +07:00 [INF] Removing 0 grants
2019-12-30 19:10:37.363 +07:00 [INF] Removing 0 grants
2019-12-30 19:11:07.379 +07:00 [INF] Removing 0 grants
2019-12-30 19:11:37.413 +07:00 [INF] Removing 0 grants
2019-12-30 19:12:07.425 +07:00 [INF] Removing 0 grants
2019-12-30 19:12:37.428 +07:00 [INF] Removing 0 grants
2019-12-30 19:13:07.442 +07:00 [INF] Removing 0 grants
2019-12-30 19:13:37.458 +07:00 [INF] Removing 0 grants
2019-12-30 19:14:07.472 +07:00 [INF] Removing 0 grants
2019-12-30 19:14:37.495 +07:00 [INF] Removing 0 grants
2019-12-30 19:15:07.504 +07:00 [INF] Removing 0 grants
2019-12-30 19:15:37.520 +07:00 [INF] Removing 0 grants
2019-12-30 19:16:07.521 +07:00 [INF] Removing 0 grants
2019-12-30 19:16:37.536 +07:00 [INF] Removing 0 grants
2019-12-30 19:17:07.552 +07:00 [INF] Removing 0 grants
2019-12-30 19:17:37.569 +07:00 [INF] Removing 0 grants
2019-12-30 19:18:07.583 +07:00 [INF] Removing 0 grants
2019-12-30 19:18:37.597 +07:00 [INF] Removing 0 grants
2019-12-30 19:19:07.612 +07:00 [INF] Removing 0 grants
2019-12-30 19:19:37.613 +07:00 [INF] Removing 0 grants
2019-12-30 19:20:07.630 +07:00 [INF] Removing 0 grants
2019-12-30 19:20:37.644 +07:00 [INF] Removing 0 grants
2019-12-30 19:21:07.661 +07:00 [INF] Removing 0 grants
2019-12-30 19:21:37.676 +07:00 [INF] Removing 0 grants
2019-12-30 19:22:07.692 +07:00 [INF] Removing 0 grants
2019-12-30 19:22:37.692 +07:00 [INF] Removing 0 grants
2019-12-30 19:23:07.708 +07:00 [INF] Removing 0 grants
2019-12-30 19:23:37.710 +07:00 [INF] Removing 0 grants
2019-12-30 19:24:07.724 +07:00 [INF] Removing 0 grants
2019-12-30 19:24:37.739 +07:00 [INF] Removing 0 grants
2019-12-30 19:25:07.749 +07:00 [INF] Removing 0 grants
2019-12-30 19:25:37.755 +07:00 [INF] Removing 0 grants
2019-12-30 19:26:07.769 +07:00 [INF] Removing 0 grants
2019-12-30 19:26:37.779 +07:00 [INF] Removing 0 grants
2019-12-30 19:27:07.793 +07:00 [INF] Removing 0 grants
2019-12-30 19:27:37.806 +07:00 [INF] Removing 0 grants
2019-12-30 19:28:07.821 +07:00 [INF] Removing 0 grants
2019-12-30 19:28:37.838 +07:00 [INF] Removing 0 grants
2019-12-30 19:29:07.853 +07:00 [INF] Removing 0 grants
2019-12-30 19:29:37.862 +07:00 [INF] Removing 0 grants
2019-12-30 19:30:07.866 +07:00 [INF] Removing 0 grants
2019-12-30 19:30:37.879 +07:00 [INF] Removing 0 grants
2019-12-30 19:31:07.895 +07:00 [INF] Removing 0 grants
2019-12-30 19:31:37.896 +07:00 [INF] Removing 0 grants
2019-12-30 19:32:07.911 +07:00 [INF] Removing 0 grants
2019-12-30 19:32:37.925 +07:00 [INF] Removing 0 grants
2019-12-30 19:33:07.928 +07:00 [INF] Removing 0 grants
2019-12-30 19:33:37.942 +07:00 [INF] Removing 0 grants
2019-12-30 19:34:07.944 +07:00 [INF] Removing 0 grants
2019-12-30 19:34:37.957 +07:00 [INF] Removing 0 grants
2019-12-30 19:35:07.973 +07:00 [INF] Removing 0 grants
2019-12-30 19:35:37.976 +07:00 [INF] Removing 0 grants
2019-12-30 19:36:07.988 +07:00 [INF] Removing 0 grants
2019-12-30 19:36:38.004 +07:00 [INF] Removing 0 grants
2019-12-30 19:37:08.011 +07:00 [INF] Removing 0 grants
2019-12-30 19:37:38.018 +07:00 [INF] Removing 0 grants
2019-12-30 19:38:08.020 +07:00 [INF] Removing 0 grants
2019-12-30 19:38:38.036 +07:00 [INF] Removing 0 grants
2019-12-30 19:39:08.052 +07:00 [INF] Removing 0 grants
2019-12-30 19:39:38.067 +07:00 [INF] Removing 0 grants
2019-12-30 19:40:08.081 +07:00 [INF] Removing 0 grants
2019-12-30 19:40:38.099 +07:00 [INF] Removing 0 grants
2019-12-30 19:41:08.116 +07:00 [INF] Removing 0 grants
2019-12-30 19:41:38.128 +07:00 [INF] Removing 0 grants
2019-12-30 19:42:08.130 +07:00 [INF] Removing 0 grants
2019-12-30 19:42:38.143 +07:00 [INF] Removing 0 grants
2019-12-30 19:43:08.156 +07:00 [INF] Removing 0 grants
2019-12-30 19:43:38.171 +07:00 [INF] Removing 0 grants
2019-12-30 19:44:08.186 +07:00 [INF] Removing 0 grants
2019-12-30 19:44:38.199 +07:00 [INF] Removing 0 grants
2019-12-30 19:45:08.212 +07:00 [INF] Removing 0 grants
2019-12-30 19:45:38.223 +07:00 [INF] Removing 0 grants
2019-12-30 19:46:08.240 +07:00 [INF] Removing 0 grants
2019-12-30 19:46:38.253 +07:00 [INF] Removing 0 grants
2019-12-30 19:47:08.254 +07:00 [INF] Removing 0 grants
2019-12-30 19:47:38.268 +07:00 [INF] Removing 0 grants
2019-12-30 19:48:08.269 +07:00 [INF] Removing 0 grants
2019-12-30 19:48:38.284 +07:00 [INF] Removing 0 grants
2019-12-30 19:49:08.298 +07:00 [INF] Removing 0 grants
2019-12-30 19:49:38.301 +07:00 [INF] Removing 0 grants
2019-12-30 19:50:08.315 +07:00 [INF] Removing 0 grants
2019-12-30 19:50:38.327 +07:00 [INF] Removing 0 grants
2019-12-30 19:51:08.332 +07:00 [INF] Removing 0 grants
2019-12-30 19:51:38.351 +07:00 [INF] Removing 0 grants
2019-12-30 19:52:08.363 +07:00 [INF] Removing 0 grants
2019-12-30 19:52:38.379 +07:00 [INF] Removing 0 grants
2019-12-30 19:53:08.395 +07:00 [INF] Removing 0 grants
2019-12-30 19:53:38.408 +07:00 [INF] Removing 0 grants
2019-12-30 19:54:08.411 +07:00 [INF] Removing 0 grants
2019-12-30 19:54:38.425 +07:00 [INF] Removing 0 grants
2019-12-30 19:55:08.448 +07:00 [INF] Removing 0 grants
2019-12-30 19:55:38.461 +07:00 [INF] Removing 0 grants
2019-12-30 19:56:08.475 +07:00 [INF] Removing 0 grants
2019-12-30 19:56:38.488 +07:00 [INF] Removing 0 grants
2019-12-30 19:57:08.491 +07:00 [INF] Removing 0 grants
2019-12-30 19:57:38.504 +07:00 [INF] Removing 0 grants
2019-12-30 19:58:08.521 +07:00 [INF] Removing 0 grants
2019-12-30 19:58:38.538 +07:00 [INF] Removing 0 grants
2019-12-30 19:59:07.381 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 19:59:07.381 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 19:59:07.381 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 19:59:07.382 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 19:59:07.383 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 19:59:07.383 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 19:59:07.383 +07:00 [DBG] Start discovery request
2019-12-30 19:59:07.409 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 19:59:07.409 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 19:59:07.410 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 19:59:07.410 +07:00 [DBG] Start authorize request
2019-12-30 19:59:07.410 +07:00 [DBG] No user present in authorize request
2019-12-30 19:59:07.410 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 19:59:07.410 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 19:59:07.410 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 19:59:07.411 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"f07a49bf86c04fa2a679a499dc521524","UiLocales":null,"Nonce":"b4d241dc31a144299a6f8aa689b34d77","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"f07a49bf86c04fa2a679a499dc521524","nonce":"b4d241dc31a144299a6f8aa689b34d77"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 19:59:07.411 +07:00 [INF] Showing login: User is not authenticated
2019-12-30 19:59:07.422 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 19:59:07.422 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 19:59:07.422 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 19:59:07.422 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 19:59:08.549 +07:00 [INF] Removing 0 grants
2019-12-30 19:59:11.861 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 19:59:11.861 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 19:59:11.862 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 19:59:11.862 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 19:59:11.865 +07:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-12-30 19:59:11.866 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-12-30 19:59:11.866 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-12-30 19:59:11.866 +07:00 [DBG] Start authorize callback request
2019-12-30 19:59:11.866 +07:00 [DBG] No user present in authorize request
2019-12-30 19:59:11.866 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 19:59:11.866 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 19:59:11.866 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 19:59:11.866 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"f07a49bf86c04fa2a679a499dc521524","UiLocales":null,"Nonce":"b4d241dc31a144299a6f8aa689b34d77","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"f07a49bf86c04fa2a679a499dc521524","nonce":"b4d241dc31a144299a6f8aa689b34d77"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 19:59:11.866 +07:00 [INF] Error: User denied consent
2019-12-30 19:59:11.867 +07:00 [INF] {"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"f07a49bf86c04fa2a679a499dc521524","UiLocales":null,"Nonce":"b4d241dc31a144299a6f8aa689b34d77","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"f07a49bf86c04fa2a679a499dc521524","nonce":"b4d241dc31a144299a6f8aa689b34d77"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 19:59:38.552 +07:00 [INF] Removing 0 grants
2019-12-30 20:00:08.567 +07:00 [INF] Removing 0 grants
2019-12-30 20:00:38.582 +07:00 [INF] Removing 0 grants
2019-12-30 20:01:08.592 +07:00 [INF] Removing 0 grants
2019-12-30 20:01:38.621 +07:00 [INF] Removing 0 grants
2019-12-30 20:02:08.629 +07:00 [INF] Removing 0 grants
2019-12-30 20:02:38.640 +07:00 [INF] Removing 0 grants
2019-12-30 20:03:08.641 +07:00 [INF] Removing 0 grants
2019-12-30 20:03:38.644 +07:00 [INF] Removing 0 grants
2019-12-30 20:04:08.650 +07:00 [INF] Removing 0 grants
2019-12-30 20:04:38.660 +07:00 [INF] Removing 0 grants
2019-12-30 20:05:08.677 +07:00 [INF] Removing 0 grants
2019-12-30 20:05:38.692 +07:00 [INF] Removing 0 grants
2019-12-30 20:06:08.693 +07:00 [INF] Removing 0 grants
2019-12-30 20:06:38.708 +07:00 [INF] Removing 0 grants
2019-12-30 20:07:08.723 +07:00 [INF] Removing 0 grants
2019-12-30 20:07:38.738 +07:00 [INF] Removing 0 grants
2019-12-30 20:08:08.749 +07:00 [INF] Removing 0 grants
2019-12-30 20:08:38.762 +07:00 [INF] Removing 0 grants
2019-12-30 20:09:08.777 +07:00 [INF] Removing 0 grants
2019-12-30 20:09:38.788 +07:00 [INF] Removing 0 grants
2019-12-30 20:10:08.806 +07:00 [INF] Removing 0 grants
2019-12-30 20:10:38.818 +07:00 [INF] Removing 0 grants
2019-12-30 20:11:08.834 +07:00 [INF] Removing 0 grants
2019-12-30 20:11:38.868 +07:00 [INF] Removing 0 grants
2019-12-30 20:12:08.884 +07:00 [INF] Removing 0 grants
2019-12-30 20:12:38.896 +07:00 [INF] Removing 0 grants
2019-12-30 20:13:08.941 +07:00 [INF] Removing 0 grants
2019-12-30 20:13:38.959 +07:00 [INF] Removing 0 grants
2019-12-30 20:14:08.972 +07:00 [INF] Removing 0 grants
2019-12-30 20:14:38.991 +07:00 [INF] Removing 0 grants
2019-12-30 20:15:09.003 +07:00 [INF] Removing 0 grants
2019-12-30 20:15:39.006 +07:00 [INF] Removing 0 grants
2019-12-30 20:16:09.023 +07:00 [INF] Removing 0 grants
2019-12-30 20:16:39.038 +07:00 [INF] Removing 0 grants
2019-12-30 20:17:09.052 +07:00 [INF] Removing 0 grants
2019-12-30 20:17:39.066 +07:00 [INF] Removing 0 grants
2019-12-30 20:18:09.080 +07:00 [INF] Removing 0 grants
2019-12-30 20:18:39.096 +07:00 [INF] Removing 0 grants
2019-12-30 20:19:09.114 +07:00 [INF] Removing 0 grants
2019-12-30 20:19:39.129 +07:00 [INF] Removing 0 grants
2019-12-30 20:20:09.144 +07:00 [INF] Removing 0 grants
2019-12-30 20:20:39.147 +07:00 [INF] Removing 0 grants
2019-12-30 20:21:09.164 +07:00 [INF] Removing 0 grants
2019-12-30 20:21:39.178 +07:00 [INF] Removing 0 grants
2019-12-30 20:22:09.192 +07:00 [INF] Removing 0 grants
2019-12-30 20:22:39.216 +07:00 [INF] Removing 0 grants
2019-12-30 20:23:09.227 +07:00 [INF] Removing 0 grants
2019-12-30 20:23:39.243 +07:00 [INF] Removing 0 grants
2019-12-30 20:24:09.254 +07:00 [INF] Removing 0 grants
2019-12-30 20:24:39.270 +07:00 [INF] Removing 0 grants
2019-12-30 20:25:09.286 +07:00 [INF] Removing 0 grants
2019-12-30 20:25:39.289 +07:00 [INF] Removing 0 grants
2019-12-30 20:26:09.290 +07:00 [INF] Removing 0 grants
2019-12-30 20:26:39.302 +07:00 [INF] Removing 0 grants
2019-12-30 20:27:09.318 +07:00 [INF] Removing 0 grants
2019-12-30 20:27:39.331 +07:00 [INF] Removing 0 grants
2019-12-30 20:28:09.349 +07:00 [INF] Removing 0 grants
2019-12-30 20:28:39.366 +07:00 [INF] Removing 0 grants
2019-12-30 20:29:09.382 +07:00 [INF] Removing 0 grants
2019-12-30 20:29:39.399 +07:00 [INF] Removing 0 grants
2019-12-30 20:30:09.415 +07:00 [INF] Removing 0 grants
2019-12-30 20:30:39.425 +07:00 [INF] Removing 0 grants
2019-12-30 20:31:09.441 +07:00 [INF] Removing 0 grants
2019-12-30 20:31:39.441 +07:00 [INF] Removing 0 grants
2019-12-30 20:32:09.458 +07:00 [INF] Removing 0 grants
2019-12-30 20:32:39.459 +07:00 [INF] Removing 0 grants
2019-12-30 20:33:09.477 +07:00 [INF] Removing 0 grants
2019-12-30 20:33:39.490 +07:00 [INF] Removing 0 grants
2019-12-30 20:34:09.504 +07:00 [INF] Removing 0 grants
2019-12-30 20:34:39.520 +07:00 [INF] Removing 0 grants
2019-12-30 20:35:09.535 +07:00 [INF] Removing 0 grants
2019-12-30 20:35:39.548 +07:00 [INF] Removing 0 grants
2019-12-30 20:36:09.552 +07:00 [INF] Removing 0 grants
2019-12-30 20:36:39.567 +07:00 [INF] Removing 0 grants
2019-12-30 20:37:09.568 +07:00 [INF] Removing 0 grants
2019-12-30 20:37:39.583 +07:00 [INF] Removing 0 grants
2019-12-30 20:38:09.592 +07:00 [INF] Removing 0 grants
2019-12-30 20:38:16.809 +07:00 [DBG] CORS request made for path: /api/account from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-12-30 20:38:16.951 +07:00 [WRN] User 321bc31e-46d6-4293-bb09-49b8b39b86f2 password validation failed: PasswordRequiresNonAlphanumeric;PasswordRequiresDigit;PasswordRequiresUpper.
2019-12-30 20:38:32.492 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 20:38:32.493 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 20:38:32.493 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 20:38:32.493 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 20:38:32.493 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 20:38:32.493 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 20:38:32.493 +07:00 [DBG] Start discovery request
2019-12-30 20:38:32.508 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 20:38:32.509 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 20:38:32.509 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 20:38:32.509 +07:00 [DBG] Start authorize request
2019-12-30 20:38:32.509 +07:00 [DBG] No user present in authorize request
2019-12-30 20:38:32.509 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 20:38:32.509 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:38:32.510 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 20:38:32.528 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"042d9bf5e2954112b1d0ea87fc256bb6","UiLocales":null,"Nonce":"30244fd8c4d649cea14507bea5f4ec26","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"042d9bf5e2954112b1d0ea87fc256bb6","nonce":"30244fd8c4d649cea14507bea5f4ec26"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 20:38:32.528 +07:00 [INF] Showing login: User is not authenticated
2019-12-30 20:38:32.533 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 20:38:32.533 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:38:32.533 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 20:38:32.534 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:38:39.609 +07:00 [INF] Removing 0 grants
2019-12-30 20:39:09.625 +07:00 [INF] Removing 0 grants
2019-12-30 20:39:39.629 +07:00 [INF] Removing 0 grants
2019-12-30 20:40:09.646 +07:00 [INF] Removing 0 grants
2019-12-30 20:40:39.660 +07:00 [INF] Removing 0 grants
2019-12-30 20:41:09.679 +07:00 [INF] Removing 0 grants
2019-12-30 20:41:39.691 +07:00 [INF] Removing 0 grants
2019-12-30 20:42:09.709 +07:00 [INF] Removing 0 grants
2019-12-30 20:42:39.747 +07:00 [INF] Removing 0 grants
2019-12-30 20:43:09.757 +07:00 [INF] Removing 0 grants
2019-12-30 20:43:39.768 +07:00 [INF] Removing 0 grants
2019-12-30 20:44:09.786 +07:00 [INF] Removing 0 grants
2019-12-30 20:44:39.801 +07:00 [INF] Removing 0 grants
2019-12-30 20:45:09.804 +07:00 [INF] Removing 0 grants
2019-12-30 20:45:39.822 +07:00 [INF] Removing 0 grants
2019-12-30 20:46:09.832 +07:00 [INF] Removing 0 grants
2019-12-30 20:46:39.849 +07:00 [INF] Removing 0 grants
2019-12-30 20:47:09.863 +07:00 [INF] Removing 0 grants
2019-12-30 20:47:39.879 +07:00 [INF] Removing 0 grants
2019-12-30 20:48:09.881 +07:00 [INF] Removing 0 grants
2019-12-30 20:48:39.896 +07:00 [INF] Removing 0 grants
2019-12-30 20:49:09.909 +07:00 [INF] Removing 0 grants
2019-12-30 20:49:39.925 +07:00 [INF] Removing 0 grants
2019-12-30 20:49:54.771 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 20:49:54.771 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 20:49:54.771 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 20:49:54.771 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 20:49:54.772 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 20:49:54.772 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 20:49:54.772 +07:00 [DBG] Start discovery request
2019-12-30 20:49:54.784 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 20:49:54.786 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 20:49:54.786 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 20:49:54.786 +07:00 [DBG] Start authorize request
2019-12-30 20:49:54.787 +07:00 [DBG] No user present in authorize request
2019-12-30 20:49:54.787 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 20:49:54.787 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:49:54.787 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 20:49:54.787 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"5632cf1e09b642a69ea0c9668157eaf6","UiLocales":null,"Nonce":"902f8f6881984abaa1d05bbff6875f58","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"5632cf1e09b642a69ea0c9668157eaf6","nonce":"902f8f6881984abaa1d05bbff6875f58"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 20:49:54.787 +07:00 [INF] Showing login: User is not authenticated
2019-12-30 20:49:54.791 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 20:49:54.791 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:49:54.791 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 20:49:54.791 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:49:56.498 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 20:49:56.499 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:49:56.499 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 20:49:56.499 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:49:56.502 +07:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-12-30 20:49:56.502 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-12-30 20:49:56.503 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-12-30 20:49:56.503 +07:00 [DBG] Start authorize callback request
2019-12-30 20:49:56.503 +07:00 [DBG] No user present in authorize request
2019-12-30 20:49:56.503 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 20:49:56.504 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:49:56.504 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 20:49:56.504 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"5632cf1e09b642a69ea0c9668157eaf6","UiLocales":null,"Nonce":"902f8f6881984abaa1d05bbff6875f58","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"5632cf1e09b642a69ea0c9668157eaf6","nonce":"902f8f6881984abaa1d05bbff6875f58"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 20:49:56.504 +07:00 [INF] Error: User denied consent
2019-12-30 20:49:56.504 +07:00 [INF] {"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"5632cf1e09b642a69ea0c9668157eaf6","UiLocales":null,"Nonce":"902f8f6881984abaa1d05bbff6875f58","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"5632cf1e09b642a69ea0c9668157eaf6","nonce":"902f8f6881984abaa1d05bbff6875f58"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 20:50:09.942 +07:00 [INF] Removing 0 grants
2019-12-30 20:50:39.960 +07:00 [INF] Removing 0 grants
2019-12-30 20:51:01.211 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 20:51:01.212 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 20:51:01.212 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 20:51:01.212 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 20:51:01.212 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 20:51:01.212 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 20:51:01.212 +07:00 [DBG] Start discovery request
2019-12-30 20:51:01.228 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 20:51:01.229 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 20:51:01.229 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 20:51:01.229 +07:00 [DBG] Start authorize request
2019-12-30 20:51:01.229 +07:00 [DBG] No user present in authorize request
2019-12-30 20:51:01.229 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 20:51:01.229 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:51:01.229 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 20:51:01.229 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"5987766d5b3b47c4bc97dcd30bbfc95f","UiLocales":null,"Nonce":"62c91a1778254d088cc022015d5c492d","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"5987766d5b3b47c4bc97dcd30bbfc95f","nonce":"62c91a1778254d088cc022015d5c492d"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 20:51:01.229 +07:00 [INF] Showing login: User is not authenticated
2019-12-30 20:51:01.234 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 20:51:01.234 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:51:01.234 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 20:51:01.234 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:51:02.696 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 20:51:02.696 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:51:02.696 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 20:51:02.697 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:51:02.700 +07:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-12-30 20:51:02.700 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-12-30 20:51:02.700 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-12-30 20:51:02.700 +07:00 [DBG] Start authorize callback request
2019-12-30 20:51:02.701 +07:00 [DBG] No user present in authorize request
2019-12-30 20:51:02.701 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 20:51:02.701 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:51:02.701 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 20:51:02.701 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"5987766d5b3b47c4bc97dcd30bbfc95f","UiLocales":null,"Nonce":"62c91a1778254d088cc022015d5c492d","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"5987766d5b3b47c4bc97dcd30bbfc95f","nonce":"62c91a1778254d088cc022015d5c492d"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 20:51:02.701 +07:00 [INF] Error: User denied consent
2019-12-30 20:51:02.701 +07:00 [INF] {"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"5987766d5b3b47c4bc97dcd30bbfc95f","UiLocales":null,"Nonce":"62c91a1778254d088cc022015d5c492d","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"5987766d5b3b47c4bc97dcd30bbfc95f","nonce":"62c91a1778254d088cc022015d5c492d"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 20:51:09.973 +07:00 [INF] Removing 0 grants
2019-12-30 20:51:39.989 +07:00 [INF] Removing 0 grants
2019-12-30 20:52:10.005 +07:00 [INF] Removing 0 grants
2019-12-30 20:52:40.021 +07:00 [INF] Removing 0 grants
2019-12-30 20:53:10.036 +07:00 [INF] Removing 0 grants
2019-12-30 20:53:40.057 +07:00 [INF] Removing 0 grants
2019-12-30 20:54:10.068 +07:00 [INF] Removing 0 grants
2019-12-30 20:54:33.545 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 20:54:33.545 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 20:54:33.545 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 20:54:33.546 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 20:54:33.546 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 20:54:33.546 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 20:54:33.546 +07:00 [DBG] Start discovery request
2019-12-30 20:54:33.564 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 20:54:33.564 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 20:54:33.564 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 20:54:33.564 +07:00 [DBG] Start authorize request
2019-12-30 20:54:33.564 +07:00 [DBG] No user present in authorize request
2019-12-30 20:54:33.564 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 20:54:33.565 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:54:33.565 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 20:54:33.567 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"121021d108254fdea5236f3990fe5396","UiLocales":null,"Nonce":"e3d7702723ec414f9517c6dde8fb0bd1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"121021d108254fdea5236f3990fe5396","nonce":"e3d7702723ec414f9517c6dde8fb0bd1"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 20:54:33.567 +07:00 [INF] Showing login: User is not authenticated
2019-12-30 20:54:33.572 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 20:54:33.572 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:54:33.572 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 20:54:33.572 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:54:40.081 +07:00 [INF] Removing 0 grants
2019-12-30 20:54:44.033 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 20:54:44.033 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:54:44.033 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 20:54:44.198 +07:00 [DBG] Augmenting SignInContext
2019-12-30 20:54:44.201 +07:00 [DBG] Adding idp claim with value: local
2019-12-30 20:54:44.202 +07:00 [DBG] Adding amr claim with value: pwd
2019-12-30 20:54:44.215 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:54:44.245 +07:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-12-30 20:54:44.245 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-12-30 20:54:44.245 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-12-30 20:54:44.245 +07:00 [DBG] Start authorize callback request
2019-12-30 20:54:44.246 +07:00 [DBG] User in authorize request: e2f360c0-3784-489a-ab74-b85654db43d8
2019-12-30 20:54:44.246 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 20:54:44.246 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:54:44.246 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 20:54:44.246 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"e2f360c0-3784-489a-ab74-b85654db43d8","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"121021d108254fdea5236f3990fe5396","UiLocales":null,"Nonce":"e3d7702723ec414f9517c6dde8fb0bd1","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"3ca39cc0ebc6fbb24043ec662848f3c3","Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"121021d108254fdea5236f3990fe5396","nonce":"e3d7702723ec414f9517c6dde8fb0bd1"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 20:54:44.267 +07:00 [DBG] Client is configured to not require consent, no consent is required
2019-12-30 20:54:44.275 +07:00 [DBG] Creating Implicit Flow response.
2019-12-30 20:54:44.286 +07:00 [DBG] Getting claims for access token for client: angular_spa
2019-12-30 20:54:44.286 +07:00 [DBG] Getting claims for access token for subject: e2f360c0-3784-489a-ab74-b85654db43d8
2019-12-30 20:54:44.590 +07:00 [DBG] Getting claims for identity token for subject: e2f360c0-3784-489a-ab74-b85654db43d8 and client: angular_spa
2019-12-30 20:54:44.591 +07:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-12-30 20:54:44.605 +07:00 [INF] Authorize endpoint response
{"SubjectId":"e2f360c0-3784-489a-ab74-b85654db43d8","ClientId":"angular_spa","RedirectUri":"http://localhost:4200/auth-callback","State":"121021d108254fdea5236f3990fe5396","Scope":"openid profile email api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-12-30 20:54:44.617 +07:00 [DBG] Augmenting SignInContext
2019-12-30 20:54:45.784 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 20:54:45.784 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 20:54:45.784 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 20:54:45.785 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 20:54:45.785 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 20:54:45.785 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 20:54:45.785 +07:00 [DBG] Start discovery request
2019-12-30 20:54:45.861 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-12-30 20:54:45.862 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 20:54:45.862 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 20:54:45.862 +07:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-12-30 20:54:45.873 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-12-30 20:54:45.873 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-12-30 20:54:45.878 +07:00 [DBG] Start key discovery request
2019-12-30 20:54:45.933 +07:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-12-30 20:54:45.933 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 20:54:45.933 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 20:54:45.951 +07:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-12-30 20:54:45.954 +07:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-12-30 20:54:45.954 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-12-30 20:54:45.961 +07:00 [DBG] Start userinfo request
2019-12-30 20:54:45.965 +07:00 [DBG] Bearer token found in header
2019-12-30 20:54:46.000 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:54:46.003 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 20:54:46.010 +07:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-12-30 20:54:46.013 +07:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1577714084,"exp":1577717684,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourceapi"],"client_id":"angular_spa","sub":"e2f360c0-3784-489a-ab74-b85654db43d8","auth_time":1577714084,"idp":"local","given_name":"Chu Sỹ Duy","email":"duycs@outlook.com","http://schemas.microsoft.com/ws/2008/06/identity/claims/role":"consumer","scope":["openid","profile","email","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-12-30 20:54:46.022 +07:00 [DBG] Creating userinfo response
2019-12-30 20:54:46.026 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 20:54:46.029 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 20:54:46.032 +07:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-12-30 20:54:46.032 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 20:54:46.036 +07:00 [INF] Profile service returned the following claim types: sub name email preferred_username email email_verified given_name email http://schemas.microsoft.com/ws/2008/06/identity/claims/role
2019-12-30 20:54:46.037 +07:00 [DBG] End userinfo request
2019-12-30 20:54:46.051 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 20:54:46.051 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 20:54:46.051 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 20:54:46.051 +07:00 [DBG] Rendering check session result
2019-12-30 20:55:10.096 +07:00 [INF] Removing 0 grants
2019-12-30 20:55:40.115 +07:00 [INF] Removing 0 grants
2019-12-30 20:56:10.129 +07:00 [INF] Removing 0 grants
2019-12-30 20:56:40.141 +07:00 [INF] Removing 0 grants
2019-12-30 20:57:10.145 +07:00 [INF] Removing 0 grants
2019-12-30 20:57:40.162 +07:00 [INF] Removing 0 grants
2019-12-30 20:58:10.167 +07:00 [INF] Removing 0 grants
2019-12-30 20:58:28.275 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 20:58:28.275 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 20:58:28.277 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 20:58:28.277 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 20:58:28.278 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 20:58:28.278 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 20:58:28.278 +07:00 [DBG] Start discovery request
2019-12-30 20:58:28.322 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 20:58:28.322 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 20:58:28.322 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 20:58:28.322 +07:00 [DBG] Rendering check session result
2019-12-30 20:58:40.182 +07:00 [INF] Removing 0 grants
2019-12-30 20:59:10.229 +07:00 [INF] Removing 0 grants
2019-12-30 20:59:40.239 +07:00 [INF] Removing 0 grants
2019-12-30 21:00:10.258 +07:00 [INF] Removing 0 grants
2019-12-30 21:00:16.130 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:00:16.130 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:00:16.130 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:00:16.130 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:00:16.131 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:00:16.131 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:00:16.131 +07:00 [DBG] Start discovery request
2019-12-30 21:00:16.166 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:00:16.166 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:00:16.166 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:00:16.166 +07:00 [DBG] Rendering check session result
2019-12-30 21:00:40.277 +07:00 [INF] Removing 0 grants
2019-12-30 21:01:10.286 +07:00 [INF] Removing 0 grants
2019-12-30 21:01:38.059 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:01:38.059 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:01:38.059 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:01:38.060 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:01:38.060 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:01:38.060 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:01:38.060 +07:00 [DBG] Start discovery request
2019-12-30 21:01:38.086 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:01:38.086 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:01:38.086 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:01:38.086 +07:00 [DBG] Rendering check session result
2019-12-30 21:01:40.302 +07:00 [INF] Removing 0 grants
2019-12-30 21:02:10.315 +07:00 [INF] Removing 0 grants
2019-12-30 21:02:40.318 +07:00 [INF] Removing 0 grants
2019-12-30 21:03:10.322 +07:00 [INF] Removing 0 grants
2019-12-30 21:03:16.462 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:03:16.462 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:03:16.462 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:03:16.462 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:03:16.462 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:03:16.462 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:03:16.462 +07:00 [DBG] Start discovery request
2019-12-30 21:03:16.514 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:03:16.514 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:03:16.514 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:03:16.514 +07:00 [DBG] Rendering check session result
2019-12-30 21:03:40.336 +07:00 [INF] Removing 0 grants
2019-12-30 21:04:10.348 +07:00 [INF] Removing 0 grants
2019-12-30 21:04:40.363 +07:00 [INF] Removing 0 grants
2019-12-30 21:05:10.376 +07:00 [INF] Removing 0 grants
2019-12-30 21:05:40.383 +07:00 [INF] Removing 0 grants
2019-12-30 21:06:10.399 +07:00 [INF] Removing 0 grants
2019-12-30 21:06:40.415 +07:00 [INF] Removing 0 grants
2019-12-30 21:07:10.433 +07:00 [INF] Removing 0 grants
2019-12-30 21:07:40.440 +07:00 [INF] Removing 0 grants
2019-12-30 21:08:10.444 +07:00 [INF] Removing 0 grants
2019-12-30 21:08:40.460 +07:00 [INF] Removing 0 grants
2019-12-30 21:09:10.476 +07:00 [INF] Removing 0 grants
2019-12-30 21:09:40.492 +07:00 [INF] Removing 0 grants
2019-12-30 21:10:10.505 +07:00 [INF] Removing 0 grants
2019-12-30 21:10:40.521 +07:00 [INF] Removing 0 grants
2019-12-30 21:10:44.892 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:10:44.892 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:10:44.892 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:10:44.892 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:10:44.893 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:10:44.893 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:10:44.893 +07:00 [DBG] Start discovery request
2019-12-30 21:10:44.949 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:10:44.949 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:10:44.949 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:10:44.949 +07:00 [DBG] Rendering check session result
2019-12-30 21:11:10.536 +07:00 [INF] Removing 0 grants
2019-12-30 21:11:35.984 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:11:35.985 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:11:35.985 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:11:35.985 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:11:35.985 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:11:35.985 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:11:35.985 +07:00 [DBG] Start discovery request
2019-12-30 21:11:36.074 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:11:36.074 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:11:36.074 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:11:36.074 +07:00 [DBG] Rendering check session result
2019-12-30 21:11:37.631 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:11:37.631 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:11:37.631 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:11:37.631 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:11:37.631 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:11:37.631 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:11:37.631 +07:00 [DBG] Start discovery request
2019-12-30 21:11:37.704 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:11:37.704 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:11:37.704 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:11:37.704 +07:00 [DBG] Rendering check session result
2019-12-30 21:11:40.552 +07:00 [INF] Removing 0 grants
2019-12-30 21:12:09.626 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:12:09.626 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:12:09.626 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:12:09.627 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:12:09.627 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:12:09.627 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:12:09.627 +07:00 [DBG] Start discovery request
2019-12-30 21:12:09.672 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:12:09.672 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:12:09.672 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:12:09.672 +07:00 [DBG] Rendering check session result
2019-12-30 21:12:10.567 +07:00 [INF] Removing 0 grants
2019-12-30 21:12:35.140 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:12:35.141 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:12:35.141 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:12:35.142 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:12:35.142 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:12:35.142 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:12:35.142 +07:00 [DBG] Start discovery request
2019-12-30 21:12:35.189 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:12:35.189 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:12:35.189 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:12:35.189 +07:00 [DBG] Rendering check session result
2019-12-30 21:12:40.585 +07:00 [INF] Removing 0 grants
2019-12-30 21:12:52.707 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:12:52.707 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:12:52.707 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:12:52.711 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:12:52.711 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:12:52.711 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:12:52.711 +07:00 [DBG] Start discovery request
2019-12-30 21:12:52.761 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:12:52.762 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:12:52.762 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:12:52.762 +07:00 [DBG] Rendering check session result
2019-12-30 21:12:56.930 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 21:12:56.931 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 21:12:56.931 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 21:12:56.931 +07:00 [DBG] Start authorize request
2019-12-30 21:12:56.931 +07:00 [DBG] User in authorize request: e2f360c0-3784-489a-ab74-b85654db43d8
2019-12-30 21:12:56.931 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 21:12:56.931 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:12:56.932 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 21:12:56.932 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"e2f360c0-3784-489a-ab74-b85654db43d8","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"f65a886d020e40648f7893ab67f795c4","UiLocales":null,"Nonce":"04129c57a634456398b7e1ea131fd3fb","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"3ca39cc0ebc6fbb24043ec662848f3c3","Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"f65a886d020e40648f7893ab67f795c4","nonce":"04129c57a634456398b7e1ea131fd3fb"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 21:12:56.941 +07:00 [DBG] Client is configured to not require consent, no consent is required
2019-12-30 21:12:56.942 +07:00 [DBG] Creating Implicit Flow response.
2019-12-30 21:12:56.942 +07:00 [DBG] Getting claims for access token for client: angular_spa
2019-12-30 21:12:56.943 +07:00 [DBG] Getting claims for access token for subject: e2f360c0-3784-489a-ab74-b85654db43d8
2019-12-30 21:12:56.953 +07:00 [DBG] Getting claims for identity token for subject: e2f360c0-3784-489a-ab74-b85654db43d8 and client: angular_spa
2019-12-30 21:12:56.953 +07:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-12-30 21:12:56.955 +07:00 [INF] Authorize endpoint response
{"SubjectId":"e2f360c0-3784-489a-ab74-b85654db43d8","ClientId":"angular_spa","RedirectUri":"http://localhost:4200/auth-callback","State":"f65a886d020e40648f7893ab67f795c4","Scope":"openid profile email api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-12-30 21:12:57.599 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:12:57.600 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:12:57.600 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:12:57.600 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:12:57.600 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:12:57.600 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:12:57.600 +07:00 [DBG] Start discovery request
2019-12-30 21:12:57.607 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:12:57.608 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:12:57.608 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:12:57.608 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:12:57.608 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:12:57.609 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:12:57.609 +07:00 [DBG] Start discovery request
2019-12-30 21:12:57.633 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:12:57.633 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:12:57.633 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:12:57.633 +07:00 [DBG] Rendering check session result
2019-12-30 21:12:57.642 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-12-30 21:12:57.642 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:12:57.642 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:12:57.642 +07:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-12-30 21:12:57.646 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-12-30 21:12:57.646 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-12-30 21:12:57.646 +07:00 [DBG] Start key discovery request
2019-12-30 21:12:57.697 +07:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-12-30 21:12:57.697 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:12:57.697 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:12:57.698 +07:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-12-30 21:12:57.699 +07:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-12-30 21:12:57.699 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-12-30 21:12:57.699 +07:00 [DBG] Start userinfo request
2019-12-30 21:12:57.699 +07:00 [DBG] Bearer token found in header
2019-12-30 21:12:57.700 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:12:57.700 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:12:57.702 +07:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-12-30 21:12:57.702 +07:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1577715176,"exp":1577718776,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourceapi"],"client_id":"angular_spa","sub":"e2f360c0-3784-489a-ab74-b85654db43d8","auth_time":1577714084,"idp":"local","given_name":"Chu Sỹ Duy","email":"duycs@outlook.com","http://schemas.microsoft.com/ws/2008/06/identity/claims/role":"consumer","scope":["openid","profile","email","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-12-30 21:12:57.702 +07:00 [DBG] Creating userinfo response
2019-12-30 21:12:57.702 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 21:12:57.702 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 21:12:57.702 +07:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-12-30 21:12:57.702 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 21:12:57.705 +07:00 [INF] Profile service returned the following claim types: sub name email preferred_username email email_verified given_name email http://schemas.microsoft.com/ws/2008/06/identity/claims/role
2019-12-30 21:12:57.705 +07:00 [DBG] End userinfo request
2019-12-30 21:13:10.598 +07:00 [INF] Removing 0 grants
2019-12-30 21:13:26.627 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:13:26.627 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:13:26.627 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:13:26.627 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:13:26.627 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:13:26.627 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:13:26.627 +07:00 [DBG] Start discovery request
2019-12-30 21:13:26.681 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:13:26.681 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:13:26.681 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:13:26.681 +07:00 [DBG] Rendering check session result
2019-12-30 21:13:38.309 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:13:38.309 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:13:38.309 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:13:38.311 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:13:38.311 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:13:38.312 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:13:38.312 +07:00 [DBG] Start discovery request
2019-12-30 21:13:38.383 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:13:38.383 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:13:38.383 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:13:38.383 +07:00 [DBG] Rendering check session result
2019-12-30 21:13:40.614 +07:00 [INF] Removing 0 grants
2019-12-30 21:14:10.627 +07:00 [INF] Removing 0 grants
2019-12-30 21:14:40.634 +07:00 [INF] Removing 0 grants
2019-12-30 21:15:10.643 +07:00 [INF] Removing 0 grants
2019-12-30 21:15:40.645 +07:00 [INF] Removing 0 grants
2019-12-30 21:15:59.400 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:15:59.400 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:15:59.400 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:15:59.400 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:15:59.400 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:15:59.400 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:15:59.400 +07:00 [DBG] Start discovery request
2019-12-30 21:15:59.458 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:15:59.458 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:15:59.458 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:15:59.458 +07:00 [DBG] Rendering check session result
2019-12-30 21:16:10.661 +07:00 [INF] Removing 0 grants
2019-12-30 21:16:40.674 +07:00 [INF] Removing 0 grants
2019-12-30 21:17:10.678 +07:00 [INF] Removing 0 grants
2019-12-30 21:17:16.182 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:17:16.182 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:17:16.182 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:17:16.182 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:17:16.182 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:17:16.182 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:17:16.182 +07:00 [DBG] Start discovery request
2019-12-30 21:17:16.225 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:17:16.225 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:17:16.225 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:17:16.225 +07:00 [DBG] Rendering check session result
2019-12-30 21:17:19.461 +07:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-12-30 21:17:19.465 +07:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-12-30 21:17:19.465 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-12-30 21:17:19.487 +07:00 [DBG] Processing signout request for e2f360c0-3784-489a-ab74-b85654db43d8
2019-12-30 21:17:19.498 +07:00 [DBG] Start end session request validation
2019-12-30 21:17:19.508 +07:00 [DBG] Start identity token validation
2019-12-30 21:17:19.509 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:17:19.510 +07:00 [DBG] Client found: angular_spa / Angular SPA
2019-12-30 21:17:19.523 +07:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-12-30 21:17:19.528 +07:00 [DBG] Token validation success
{"ClientId":"angular_spa","ClientName":"Angular SPA","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1577715176,"exp":1577715476,"iss":"http://localhost:5000","aud":"angular_spa","nonce":"04129c57a634456398b7e1ea131fd3fb","iat":1577715176,"at_hash":"uXyqniqEqQ1HaoN_9hnt7w","sid":"3ca39cc0ebc6fbb24043ec662848f3c3","sub":"e2f360c0-3784-489a-ab74-b85654db43d8","auth_time":1577714084,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-12-30 21:17:19.540 +07:00 [INF] End session request validation success
{"ClientId":"angular_spa","ClientName":"Angular SPA","SubjectId":"e2f360c0-3784-489a-ab74-b85654db43d8","PostLogOutUri":"http://localhost:4200/","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:4200/"},"$type":"EndSessionRequestValidationLog"}
2019-12-30 21:17:19.542 +07:00 [DBG] Success validating end session request from angular_spa
2019-12-30 21:17:24.124 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:17:24.124 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:17:24.124 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:17:24.125 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:17:24.125 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:17:24.125 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:17:24.125 +07:00 [DBG] Start discovery request
2019-12-30 21:17:24.137 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 21:17:24.138 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 21:17:24.138 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 21:17:24.138 +07:00 [DBG] Start authorize request
2019-12-30 21:17:24.138 +07:00 [DBG] User in authorize request: e2f360c0-3784-489a-ab74-b85654db43d8
2019-12-30 21:17:24.138 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 21:17:24.138 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:17:24.139 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 21:17:24.139 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"e2f360c0-3784-489a-ab74-b85654db43d8","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"5324adbe5f38425baee5bac0573c8e8e","UiLocales":null,"Nonce":"eb808868502e42e39f2126aa9384f864","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"3ca39cc0ebc6fbb24043ec662848f3c3","Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"5324adbe5f38425baee5bac0573c8e8e","nonce":"eb808868502e42e39f2126aa9384f864"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 21:17:24.141 +07:00 [DBG] Client is configured to not require consent, no consent is required
2019-12-30 21:17:24.141 +07:00 [DBG] Creating Implicit Flow response.
2019-12-30 21:17:24.142 +07:00 [DBG] Getting claims for access token for client: angular_spa
2019-12-30 21:17:24.142 +07:00 [DBG] Getting claims for access token for subject: e2f360c0-3784-489a-ab74-b85654db43d8
2019-12-30 21:17:24.151 +07:00 [DBG] Getting claims for identity token for subject: e2f360c0-3784-489a-ab74-b85654db43d8 and client: angular_spa
2019-12-30 21:17:24.151 +07:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-12-30 21:17:24.153 +07:00 [INF] Authorize endpoint response
{"SubjectId":"e2f360c0-3784-489a-ab74-b85654db43d8","ClientId":"angular_spa","RedirectUri":"http://localhost:4200/auth-callback","State":"5324adbe5f38425baee5bac0573c8e8e","Scope":"openid profile email api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-12-30 21:17:24.802 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:17:24.803 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:17:24.803 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:17:24.806 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:17:24.808 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:17:24.810 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:17:24.810 +07:00 [DBG] Start discovery request
2019-12-30 21:17:24.826 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-12-30 21:17:24.826 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:17:24.826 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:17:24.827 +07:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-12-30 21:17:24.827 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-12-30 21:17:24.827 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-12-30 21:17:24.827 +07:00 [DBG] Start key discovery request
2019-12-30 21:17:24.848 +07:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-12-30 21:17:24.848 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:17:24.848 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:17:24.849 +07:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-12-30 21:17:24.849 +07:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-12-30 21:17:24.849 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-12-30 21:17:24.849 +07:00 [DBG] Start userinfo request
2019-12-30 21:17:24.849 +07:00 [DBG] Bearer token found in header
2019-12-30 21:17:24.850 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:17:24.850 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:17:24.852 +07:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-12-30 21:17:24.852 +07:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1577715444,"exp":1577719044,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourceapi"],"client_id":"angular_spa","sub":"e2f360c0-3784-489a-ab74-b85654db43d8","auth_time":1577714084,"idp":"local","given_name":"Chu Sỹ Duy","email":"duycs@outlook.com","http://schemas.microsoft.com/ws/2008/06/identity/claims/role":"consumer","scope":["openid","profile","email","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-12-30 21:17:24.852 +07:00 [DBG] Creating userinfo response
2019-12-30 21:17:24.852 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 21:17:24.852 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 21:17:24.852 +07:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-12-30 21:17:24.852 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 21:17:24.856 +07:00 [INF] Profile service returned the following claim types: sub name email preferred_username email email_verified given_name email http://schemas.microsoft.com/ws/2008/06/identity/claims/role
2019-12-30 21:17:24.856 +07:00 [DBG] End userinfo request
2019-12-30 21:17:24.871 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:17:24.871 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:17:24.871 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:17:24.872 +07:00 [DBG] Rendering check session result
2019-12-30 21:17:27.846 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 21:17:27.846 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 21:17:27.846 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 21:17:27.846 +07:00 [DBG] Start authorize request
2019-12-30 21:17:27.846 +07:00 [DBG] User in authorize request: e2f360c0-3784-489a-ab74-b85654db43d8
2019-12-30 21:17:27.847 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 21:17:27.847 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:17:27.847 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 21:17:27.848 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"e2f360c0-3784-489a-ab74-b85654db43d8","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"de29bd18604e446a9b222b21f778ddeb","UiLocales":null,"Nonce":"3ffd5dc71f304784b97a3c32c5ef5822","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"3ca39cc0ebc6fbb24043ec662848f3c3","Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"de29bd18604e446a9b222b21f778ddeb","nonce":"3ffd5dc71f304784b97a3c32c5ef5822"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 21:17:27.852 +07:00 [DBG] Client is configured to not require consent, no consent is required
2019-12-30 21:17:27.852 +07:00 [DBG] Creating Implicit Flow response.
2019-12-30 21:17:27.852 +07:00 [DBG] Getting claims for access token for client: angular_spa
2019-12-30 21:17:27.852 +07:00 [DBG] Getting claims for access token for subject: e2f360c0-3784-489a-ab74-b85654db43d8
2019-12-30 21:17:27.856 +07:00 [DBG] Getting claims for identity token for subject: e2f360c0-3784-489a-ab74-b85654db43d8 and client: angular_spa
2019-12-30 21:17:27.856 +07:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-12-30 21:17:27.858 +07:00 [INF] Authorize endpoint response
{"SubjectId":"e2f360c0-3784-489a-ab74-b85654db43d8","ClientId":"angular_spa","RedirectUri":"http://localhost:4200/auth-callback","State":"de29bd18604e446a9b222b21f778ddeb","Scope":"openid profile email api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-12-30 21:17:28.445 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:17:28.445 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:17:28.445 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:17:28.445 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:17:28.446 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:17:28.446 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:17:28.446 +07:00 [DBG] Start discovery request
2019-12-30 21:17:28.453 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:17:28.453 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:17:28.453 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:17:28.454 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:17:28.454 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:17:28.454 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:17:28.454 +07:00 [DBG] Start discovery request
2019-12-30 21:17:28.507 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-12-30 21:17:28.507 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:17:28.508 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:17:28.508 +07:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-12-30 21:17:28.508 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-12-30 21:17:28.509 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-12-30 21:17:28.509 +07:00 [DBG] Start key discovery request
2019-12-30 21:17:28.509 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:17:28.509 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:17:28.509 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:17:28.509 +07:00 [DBG] Rendering check session result
2019-12-30 21:17:28.530 +07:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-12-30 21:17:28.530 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:17:28.532 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:17:28.532 +07:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-12-30 21:17:28.532 +07:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-12-30 21:17:28.533 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-12-30 21:17:28.533 +07:00 [DBG] Start userinfo request
2019-12-30 21:17:28.533 +07:00 [DBG] Bearer token found in header
2019-12-30 21:17:28.535 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:17:28.535 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:17:28.547 +07:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-12-30 21:17:28.548 +07:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1577715447,"exp":1577719047,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourceapi"],"client_id":"angular_spa","sub":"e2f360c0-3784-489a-ab74-b85654db43d8","auth_time":1577714084,"idp":"local","given_name":"Chu Sỹ Duy","email":"duycs@outlook.com","http://schemas.microsoft.com/ws/2008/06/identity/claims/role":"consumer","scope":["openid","profile","email","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-12-30 21:17:28.548 +07:00 [DBG] Creating userinfo response
2019-12-30 21:17:28.548 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 21:17:28.548 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 21:17:28.548 +07:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-12-30 21:17:28.548 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 21:17:28.554 +07:00 [INF] Profile service returned the following claim types: sub name email preferred_username email email_verified given_name email http://schemas.microsoft.com/ws/2008/06/identity/claims/role
2019-12-30 21:17:28.554 +07:00 [DBG] End userinfo request
2019-12-30 21:17:40.693 +07:00 [INF] Removing 0 grants
2019-12-30 21:17:41.259 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:17:41.259 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:17:41.259 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:17:41.259 +07:00 [DBG] Rendering check session result
2019-12-30 21:18:10.697 +07:00 [INF] Removing 0 grants
2019-12-30 21:18:40.712 +07:00 [INF] Removing 0 grants
2019-12-30 21:19:10.729 +07:00 [INF] Removing 0 grants
2019-12-30 21:19:33.538 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:19:33.538 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:19:33.538 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:19:33.538 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:19:33.538 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:19:33.538 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:19:33.538 +07:00 [DBG] Start discovery request
2019-12-30 21:19:33.643 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:19:33.643 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:19:33.643 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:19:33.643 +07:00 [DBG] Rendering check session result
2019-12-30 21:19:40.741 +07:00 [INF] Removing 0 grants
2019-12-30 21:20:10.755 +07:00 [INF] Removing 0 grants
2019-12-30 21:20:40.771 +07:00 [INF] Removing 0 grants
2019-12-30 21:21:10.788 +07:00 [INF] Removing 0 grants
2019-12-30 21:21:40.805 +07:00 [INF] Removing 0 grants
2019-12-30 21:21:44.477 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:21:44.477 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:21:44.477 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:21:44.477 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:21:44.477 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:21:44.477 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:21:44.477 +07:00 [DBG] Start discovery request
2019-12-30 21:21:44.603 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:21:44.603 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:21:44.603 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:21:44.603 +07:00 [DBG] Rendering check session result
2019-12-30 21:21:53.015 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:21:53.015 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:21:53.015 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:21:53.015 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:21:53.016 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:21:53.016 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:21:53.016 +07:00 [DBG] Start discovery request
2019-12-30 21:21:53.056 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:21:53.058 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:21:53.058 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:21:53.058 +07:00 [DBG] Rendering check session result
2019-12-30 21:22:10.820 +07:00 [INF] Removing 0 grants
2019-12-30 21:22:40.837 +07:00 [INF] Removing 0 grants
2019-12-30 21:23:10.848 +07:00 [INF] Removing 0 grants
2019-12-30 21:23:19.764 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:23:19.764 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:23:19.764 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:23:19.764 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:23:19.764 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:23:19.764 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:23:19.764 +07:00 [DBG] Start discovery request
2019-12-30 21:23:19.800 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:23:19.800 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:23:19.800 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:23:19.800 +07:00 [DBG] Rendering check session result
2019-12-30 21:23:40.864 +07:00 [INF] Removing 0 grants
2019-12-30 21:24:10.864 +07:00 [INF] Removing 0 grants
2019-12-30 21:24:40.879 +07:00 [INF] Removing 0 grants
2019-12-30 21:24:54.601 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:24:54.601 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:24:54.601 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:24:54.602 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:24:54.602 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:24:54.602 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:24:54.602 +07:00 [DBG] Start discovery request
2019-12-30 21:24:54.688 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:24:54.689 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:24:54.689 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:24:54.689 +07:00 [DBG] Rendering check session result
2019-12-30 21:24:54.721 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 21:24:54.721 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 21:24:54.721 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 21:24:54.721 +07:00 [DBG] Start authorize request
2019-12-30 21:24:54.721 +07:00 [DBG] No user present in authorize request
2019-12-30 21:24:54.721 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 21:24:54.721 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:24:54.722 +07:00 [ERR] Invalid redirect_uri: http://localhost:4200/silent-refresh.html
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":null,"AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/silent-refresh.html","response_type":"id_token","scope":"openid","state":"19f0cbc4c42e4b219417d668a0c310fe","nonce":"09746d764e244a15b05b21a0aa617fb1","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 21:24:54.722 +07:00 [ERR] Request validation failed
2019-12-30 21:24:54.722 +07:00 [INF] {"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":null,"AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/silent-refresh.html","response_type":"id_token","scope":"openid","state":"19f0cbc4c42e4b219417d668a0c310fe","nonce":"09746d764e244a15b05b21a0aa617fb1","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 21:24:55.947 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:24:55.947 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:24:55.948 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:24:55.948 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:24:55.948 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:24:55.948 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:24:55.948 +07:00 [DBG] Start discovery request
2019-12-30 21:24:55.982 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:24:55.982 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:24:55.982 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:24:55.982 +07:00 [DBG] Rendering check session result
2019-12-30 21:24:56.029 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 21:24:56.029 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 21:24:56.029 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 21:24:56.029 +07:00 [DBG] Start authorize request
2019-12-30 21:24:56.029 +07:00 [DBG] No user present in authorize request
2019-12-30 21:24:56.029 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 21:24:56.029 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:24:56.030 +07:00 [ERR] Invalid redirect_uri: http://localhost:4200/silent-refresh.html
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":null,"AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/silent-refresh.html","response_type":"id_token","scope":"openid","state":"1a01e395ad0c4336bc557050e6730b2a","nonce":"e501a1bef810469ab3c578e41e2e53b6","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 21:24:56.030 +07:00 [ERR] Request validation failed
2019-12-30 21:24:56.030 +07:00 [INF] {"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":null,"AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/silent-refresh.html","response_type":"id_token","scope":"openid","state":"1a01e395ad0c4336bc557050e6730b2a","nonce":"e501a1bef810469ab3c578e41e2e53b6","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 21:25:10.895 +07:00 [INF] Removing 0 grants
2019-12-30 21:25:19.804 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:25:19.804 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:25:19.804 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:25:19.804 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:25:19.805 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:25:19.805 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:25:19.805 +07:00 [DBG] Start discovery request
2019-12-30 21:25:19.834 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:25:19.834 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:25:19.834 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:25:19.834 +07:00 [DBG] Rendering check session result
2019-12-30 21:25:19.882 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 21:25:19.882 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 21:25:19.882 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 21:25:19.883 +07:00 [DBG] Start authorize request
2019-12-30 21:25:19.883 +07:00 [DBG] No user present in authorize request
2019-12-30 21:25:19.883 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 21:25:19.883 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:25:19.883 +07:00 [ERR] Invalid redirect_uri: http://localhost:4200/silent-refresh.html
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":null,"AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/silent-refresh.html","response_type":"id_token","scope":"openid","state":"44b60c17542245af8f1664db2183fe1e","nonce":"2cef1d15723f42d487527d43e0d9779f","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 21:25:19.883 +07:00 [ERR] Request validation failed
2019-12-30 21:25:19.883 +07:00 [INF] {"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":null,"AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/silent-refresh.html","response_type":"id_token","scope":"openid","state":"44b60c17542245af8f1664db2183fe1e","nonce":"2cef1d15723f42d487527d43e0d9779f","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 21:25:40.913 +07:00 [INF] Removing 0 grants
2019-12-30 21:26:10.930 +07:00 [INF] Removing 0 grants
2019-12-30 21:26:20.700 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:26:20.700 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:26:20.700 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:26:20.700 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:26:20.700 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:26:20.700 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:26:20.700 +07:00 [DBG] Start discovery request
2019-12-30 21:26:20.758 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:26:20.758 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:26:20.758 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:26:20.758 +07:00 [DBG] Rendering check session result
2019-12-30 21:26:20.787 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 21:26:20.787 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 21:26:20.787 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 21:26:20.787 +07:00 [DBG] Start authorize request
2019-12-30 21:26:20.787 +07:00 [DBG] No user present in authorize request
2019-12-30 21:26:20.787 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 21:26:20.787 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:26:20.787 +07:00 [ERR] Invalid redirect_uri: http://localhost:4200/silent-refresh.html
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":null,"AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/silent-refresh.html","response_type":"id_token","scope":"openid","state":"dc42e0bb87de45f382ce042f5c9c0288","nonce":"77f2d609c17b4e99bb40197efa374c00","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 21:26:20.787 +07:00 [ERR] Request validation failed
2019-12-30 21:26:20.787 +07:00 [INF] {"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":null,"AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/silent-refresh.html","response_type":"id_token","scope":"openid","state":"dc42e0bb87de45f382ce042f5c9c0288","nonce":"77f2d609c17b4e99bb40197efa374c00","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 21:26:40.940 +07:00 [INF] Removing 0 grants
2019-12-30 21:26:43.935 +07:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-12-30 21:26:43.937 +07:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-12-30 21:26:43.937 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-12-30 21:26:43.937 +07:00 [DBG] Processing signout request for anonymous
2019-12-30 21:26:43.937 +07:00 [DBG] Start end session request validation
2019-12-30 21:26:43.937 +07:00 [DBG] Start identity token validation
2019-12-30 21:26:43.938 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:26:43.938 +07:00 [DBG] Client found: angular_spa / Angular SPA
2019-12-30 21:26:43.965 +07:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-12-30 21:26:43.967 +07:00 [DBG] Token validation success
{"ClientId":"angular_spa","ClientName":"Angular SPA","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1577715447,"exp":1577715747,"iss":"http://localhost:5000","aud":"angular_spa","nonce":"3ffd5dc71f304784b97a3c32c5ef5822","iat":1577715447,"at_hash":"fxDCnlW_0ZVBBwR-O1ZVtw","sid":"3ca39cc0ebc6fbb24043ec662848f3c3","sub":"e2f360c0-3784-489a-ab74-b85654db43d8","auth_time":1577714084,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-12-30 21:26:43.968 +07:00 [INF] End session request validation success
{"ClientId":"angular_spa","ClientName":"Angular SPA","SubjectId":"unknown","PostLogOutUri":"http://localhost:4200/","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:4200/"},"$type":"EndSessionRequestValidationLog"}
2019-12-30 21:26:43.968 +07:00 [DBG] Success validating end session request from angular_spa
2019-12-30 21:26:51.641 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:26:51.641 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:26:51.641 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:26:51.641 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:26:51.641 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:26:51.641 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:26:51.641 +07:00 [DBG] Start discovery request
2019-12-30 21:26:51.654 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 21:26:51.654 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 21:26:51.655 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 21:26:51.655 +07:00 [DBG] Start authorize request
2019-12-30 21:26:51.655 +07:00 [DBG] No user present in authorize request
2019-12-30 21:26:51.655 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 21:26:51.655 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:26:51.655 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 21:26:51.656 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"23667fa125b14ccfad9bebf2c3863b21","UiLocales":null,"Nonce":"fff3e6a57fa1449889279b1d0214c402","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"23667fa125b14ccfad9bebf2c3863b21","nonce":"fff3e6a57fa1449889279b1d0214c402"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 21:26:51.656 +07:00 [INF] Showing login: User is not authenticated
2019-12-30 21:26:51.659 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 21:26:51.659 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:26:51.660 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 21:26:51.660 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:27:00.253 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 21:27:00.253 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:27:00.254 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 21:27:00.268 +07:00 [WRN] Invalid password for user e2f360c0-3784-489a-ab74-b85654db43d8.
2019-12-30 21:27:00.269 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 21:27:00.269 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:27:00.270 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 21:27:00.270 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:27:04.587 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 21:27:04.587 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:27:04.587 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 21:27:04.599 +07:00 [DBG] Augmenting SignInContext
2019-12-30 21:27:04.599 +07:00 [DBG] Adding idp claim with value: local
2019-12-30 21:27:04.599 +07:00 [DBG] Adding amr claim with value: pwd
2019-12-30 21:27:04.600 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:27:04.604 +07:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-12-30 21:27:04.604 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-12-30 21:27:04.604 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-12-30 21:27:04.604 +07:00 [DBG] Start authorize callback request
2019-12-30 21:27:04.605 +07:00 [DBG] User in authorize request: e2f360c0-3784-489a-ab74-b85654db43d8
2019-12-30 21:27:04.605 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 21:27:04.605 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:27:04.605 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 21:27:04.605 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"e2f360c0-3784-489a-ab74-b85654db43d8","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"23667fa125b14ccfad9bebf2c3863b21","UiLocales":null,"Nonce":"fff3e6a57fa1449889279b1d0214c402","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"aa43f97551b8218272a8a2ea771373c8","Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"23667fa125b14ccfad9bebf2c3863b21","nonce":"fff3e6a57fa1449889279b1d0214c402"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 21:27:04.608 +07:00 [DBG] Client is configured to not require consent, no consent is required
2019-12-30 21:27:04.608 +07:00 [DBG] Creating Implicit Flow response.
2019-12-30 21:27:04.608 +07:00 [DBG] Getting claims for access token for client: angular_spa
2019-12-30 21:27:04.608 +07:00 [DBG] Getting claims for access token for subject: e2f360c0-3784-489a-ab74-b85654db43d8
2019-12-30 21:27:04.615 +07:00 [DBG] Getting claims for identity token for subject: e2f360c0-3784-489a-ab74-b85654db43d8 and client: angular_spa
2019-12-30 21:27:04.615 +07:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-12-30 21:27:04.617 +07:00 [INF] Authorize endpoint response
{"SubjectId":"e2f360c0-3784-489a-ab74-b85654db43d8","ClientId":"angular_spa","RedirectUri":"http://localhost:4200/auth-callback","State":"23667fa125b14ccfad9bebf2c3863b21","Scope":"openid profile email api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-12-30 21:27:04.617 +07:00 [DBG] Augmenting SignInContext
2019-12-30 21:27:05.581 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:27:05.581 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:27:05.581 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:27:05.582 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:27:05.589 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:27:05.589 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:27:05.589 +07:00 [DBG] Start discovery request
2019-12-30 21:27:05.639 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-12-30 21:27:05.639 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:27:05.639 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:27:05.639 +07:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-12-30 21:27:05.640 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-12-30 21:27:05.640 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-12-30 21:27:05.640 +07:00 [DBG] Start key discovery request
2019-12-30 21:27:05.690 +07:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-12-30 21:27:05.691 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:27:05.691 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:27:05.691 +07:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-12-30 21:27:05.691 +07:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-12-30 21:27:05.691 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-12-30 21:27:05.691 +07:00 [DBG] Start userinfo request
2019-12-30 21:27:05.691 +07:00 [DBG] Bearer token found in header
2019-12-30 21:27:05.692 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:27:05.692 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:27:05.694 +07:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-12-30 21:27:05.695 +07:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1577716024,"exp":1577719624,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourceapi"],"client_id":"angular_spa","sub":"e2f360c0-3784-489a-ab74-b85654db43d8","auth_time":1577716024,"idp":"local","given_name":"Chu Sỹ Duy","email":"duycs@outlook.com","http://schemas.microsoft.com/ws/2008/06/identity/claims/role":"consumer","scope":["openid","profile","email","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-12-30 21:27:05.695 +07:00 [DBG] Creating userinfo response
2019-12-30 21:27:05.695 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 21:27:05.695 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 21:27:05.695 +07:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-12-30 21:27:05.695 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 21:27:05.699 +07:00 [INF] Profile service returned the following claim types: sub name email preferred_username email email_verified given_name email http://schemas.microsoft.com/ws/2008/06/identity/claims/role
2019-12-30 21:27:05.700 +07:00 [DBG] End userinfo request
2019-12-30 21:27:05.725 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:27:05.725 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:27:05.725 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:27:05.725 +07:00 [DBG] Rendering check session result
2019-12-30 21:27:10.943 +07:00 [INF] Removing 0 grants
2019-12-30 21:27:40.962 +07:00 [INF] Removing 0 grants
2019-12-30 21:27:45.301 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:27:45.301 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:27:45.301 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:27:45.302 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:27:45.302 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:27:45.302 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:27:45.302 +07:00 [DBG] Start discovery request
2019-12-30 21:27:45.336 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:27:45.336 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:27:45.336 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:27:45.336 +07:00 [DBG] Rendering check session result
2019-12-30 21:27:47.509 +07:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2019-12-30 21:27:47.510 +07:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2019-12-30 21:27:47.510 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2019-12-30 21:27:47.510 +07:00 [DBG] Processing signout request for e2f360c0-3784-489a-ab74-b85654db43d8
2019-12-30 21:27:47.510 +07:00 [DBG] Start end session request validation
2019-12-30 21:27:47.510 +07:00 [DBG] Start identity token validation
2019-12-30 21:27:47.511 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:27:47.511 +07:00 [DBG] Client found: angular_spa / Angular SPA
2019-12-30 21:27:47.519 +07:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-12-30 21:27:47.519 +07:00 [DBG] Token validation success
{"ClientId":"angular_spa","ClientName":"Angular SPA","ValidateLifetime":false,"AccessTokenType":null,"ExpectedScope":null,"TokenHandle":null,"JwtId":null,"Claims":{"nbf":1577716024,"exp":1577716324,"iss":"http://localhost:5000","aud":"angular_spa","nonce":"fff3e6a57fa1449889279b1d0214c402","iat":1577716024,"at_hash":"ZTpsG9rVYwAzkLUnH7lBvw","sid":"aa43f97551b8218272a8a2ea771373c8","sub":"e2f360c0-3784-489a-ab74-b85654db43d8","auth_time":1577716024,"idp":"local","amr":"pwd"},"$type":"TokenValidationLog"}
2019-12-30 21:27:47.519 +07:00 [INF] End session request validation success
{"ClientId":"angular_spa","ClientName":"Angular SPA","SubjectId":"e2f360c0-3784-489a-ab74-b85654db43d8","PostLogOutUri":"http://localhost:4200/","State":null,"Raw":{"id_token_hint":"***REDACTED***","post_logout_redirect_uri":"http://localhost:4200/"},"$type":"EndSessionRequestValidationLog"}
2019-12-30 21:27:47.520 +07:00 [DBG] Success validating end session request from angular_spa
2019-12-30 21:27:50.667 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:27:50.667 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:27:50.667 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:27:50.667 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:27:50.668 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:27:50.668 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:27:50.668 +07:00 [DBG] Start discovery request
2019-12-30 21:27:50.678 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 21:27:50.678 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 21:27:50.678 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 21:27:50.678 +07:00 [DBG] Start authorize request
2019-12-30 21:27:50.678 +07:00 [DBG] User in authorize request: e2f360c0-3784-489a-ab74-b85654db43d8
2019-12-30 21:27:50.678 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 21:27:50.678 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:27:50.678 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-30 21:27:50.679 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"e2f360c0-3784-489a-ab74-b85654db43d8","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"ff29e6e3591f480ba759cfa0459b07b4","UiLocales":null,"Nonce":"7b1be90c290d45a69068303854654320","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"aa43f97551b8218272a8a2ea771373c8","Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"ff29e6e3591f480ba759cfa0459b07b4","nonce":"7b1be90c290d45a69068303854654320"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 21:27:50.687 +07:00 [DBG] Client is configured to not require consent, no consent is required
2019-12-30 21:27:50.687 +07:00 [DBG] Creating Implicit Flow response.
2019-12-30 21:27:50.687 +07:00 [DBG] Getting claims for access token for client: angular_spa
2019-12-30 21:27:50.687 +07:00 [DBG] Getting claims for access token for subject: e2f360c0-3784-489a-ab74-b85654db43d8
2019-12-30 21:27:50.695 +07:00 [DBG] Getting claims for identity token for subject: e2f360c0-3784-489a-ab74-b85654db43d8 and client: angular_spa
2019-12-30 21:27:50.695 +07:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-12-30 21:27:50.696 +07:00 [INF] Authorize endpoint response
{"SubjectId":"e2f360c0-3784-489a-ab74-b85654db43d8","ClientId":"angular_spa","RedirectUri":"http://localhost:4200/auth-callback","State":"ff29e6e3591f480ba759cfa0459b07b4","Scope":"openid profile email api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-12-30 21:27:51.321 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-30 21:27:51.322 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:27:51.322 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:27:51.326 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-30 21:27:51.326 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-30 21:27:51.326 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-30 21:27:51.326 +07:00 [DBG] Start discovery request
2019-12-30 21:27:51.346 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-12-30 21:27:51.346 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:27:51.346 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:27:51.346 +07:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-12-30 21:27:51.346 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-12-30 21:27:51.346 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-12-30 21:27:51.346 +07:00 [DBG] Start key discovery request
2019-12-30 21:27:51.370 +07:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-12-30 21:27:51.370 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-30 21:27:51.370 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-30 21:27:51.370 +07:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-12-30 21:27:51.371 +07:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-12-30 21:27:51.371 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-12-30 21:27:51.371 +07:00 [DBG] Start userinfo request
2019-12-30 21:27:51.371 +07:00 [DBG] Bearer token found in header
2019-12-30 21:27:51.371 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:27:51.371 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 21:27:51.374 +07:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-12-30 21:27:51.374 +07:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1577716070,"exp":1577719670,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourceapi"],"client_id":"angular_spa","sub":"e2f360c0-3784-489a-ab74-b85654db43d8","auth_time":1577716024,"idp":"local","given_name":"Chu Sỹ Duy","email":"duycs@outlook.com","http://schemas.microsoft.com/ws/2008/06/identity/claims/role":"consumer","scope":["openid","profile","email","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-12-30 21:27:51.374 +07:00 [DBG] Creating userinfo response
2019-12-30 21:27:51.374 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 21:27:51.374 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 21:27:51.374 +07:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-12-30 21:27:51.374 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-30 21:27:51.376 +07:00 [INF] Profile service returned the following claim types: sub name email preferred_username email email_verified given_name email http://schemas.microsoft.com/ws/2008/06/identity/claims/role
2019-12-30 21:27:51.376 +07:00 [DBG] End userinfo request
2019-12-30 21:27:51.392 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-30 21:27:51.392 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-30 21:27:51.392 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-30 21:27:51.392 +07:00 [DBG] Rendering check session result
2019-12-30 21:28:10.977 +07:00 [INF] Removing 0 grants
2019-12-30 21:28:40.989 +07:00 [INF] Removing 0 grants
2019-12-30 21:29:11.001 +07:00 [INF] Removing 0 grants
2019-12-30 21:29:41.003 +07:00 [INF] Removing 0 grants
2019-12-30 21:30:11.038 +07:00 [INF] Removing 0 grants
2019-12-30 21:30:41.054 +07:00 [INF] Removing 0 grants
2019-12-30 21:31:11.070 +07:00 [INF] Removing 0 grants
2019-12-30 21:31:41.082 +07:00 [INF] Removing 0 grants
2019-12-30 21:32:11.085 +07:00 [INF] Removing 0 grants
2019-12-30 21:32:41.100 +07:00 [INF] Removing 0 grants
2019-12-30 21:33:11.117 +07:00 [INF] Removing 0 grants
2019-12-30 21:33:41.134 +07:00 [INF] Removing 0 grants
2019-12-30 21:34:11.144 +07:00 [INF] Removing 0 grants
2019-12-30 21:34:41.157 +07:00 [INF] Removing 0 grants
2019-12-30 21:35:11.167 +07:00 [INF] Removing 0 grants
2019-12-30 21:35:41.178 +07:00 [INF] Removing 0 grants
2019-12-30 21:36:11.192 +07:00 [INF] Removing 0 grants
2019-12-30 21:36:41.208 +07:00 [INF] Removing 0 grants
2019-12-30 21:37:11.223 +07:00 [INF] Removing 0 grants
2019-12-30 21:37:41.239 +07:00 [INF] Removing 0 grants
2019-12-30 21:38:11.253 +07:00 [INF] Removing 0 grants
2019-12-30 21:38:41.257 +07:00 [INF] Removing 0 grants
2019-12-30 21:39:11.271 +07:00 [INF] Removing 0 grants
2019-12-30 21:39:41.287 +07:00 [INF] Removing 0 grants
2019-12-30 21:40:11.301 +07:00 [INF] Removing 0 grants
2019-12-30 21:40:41.317 +07:00 [INF] Removing 0 grants
2019-12-30 21:41:11.332 +07:00 [INF] Removing 0 grants
2019-12-30 21:41:41.347 +07:00 [INF] Removing 0 grants
2019-12-30 21:42:11.365 +07:00 [INF] Removing 0 grants
2019-12-30 21:42:41.379 +07:00 [INF] Removing 0 grants
2019-12-30 21:43:11.394 +07:00 [INF] Removing 0 grants
2019-12-30 21:43:41.409 +07:00 [INF] Removing 0 grants
2019-12-30 21:44:11.427 +07:00 [INF] Removing 0 grants
2019-12-30 21:44:41.442 +07:00 [INF] Removing 0 grants
2019-12-30 21:45:11.458 +07:00 [INF] Removing 0 grants
2019-12-30 21:45:41.473 +07:00 [INF] Removing 0 grants
2019-12-30 21:46:11.486 +07:00 [INF] Removing 0 grants
2019-12-30 21:46:41.488 +07:00 [INF] Removing 0 grants
2019-12-30 21:47:11.504 +07:00 [INF] Removing 0 grants
2019-12-30 21:47:41.521 +07:00 [INF] Removing 0 grants
2019-12-30 21:48:11.537 +07:00 [INF] Removing 0 grants
2019-12-30 21:48:41.553 +07:00 [INF] Removing 0 grants
2019-12-30 21:49:11.568 +07:00 [INF] Removing 0 grants
2019-12-30 21:49:41.583 +07:00 [INF] Removing 0 grants
2019-12-30 21:50:11.598 +07:00 [INF] Removing 0 grants
2019-12-30 21:50:41.614 +07:00 [INF] Removing 0 grants
2019-12-30 21:51:11.630 +07:00 [INF] Removing 0 grants
2019-12-30 21:51:41.644 +07:00 [INF] Removing 0 grants
2019-12-30 21:52:11.647 +07:00 [INF] Removing 0 grants
2019-12-30 21:52:41.661 +07:00 [INF] Removing 0 grants
2019-12-30 21:53:11.677 +07:00 [INF] Removing 0 grants
2019-12-30 21:53:41.691 +07:00 [INF] Removing 0 grants
2019-12-30 21:54:11.693 +07:00 [INF] Removing 0 grants
2019-12-30 21:54:41.694 +07:00 [INF] Removing 0 grants
2019-12-30 21:55:11.711 +07:00 [INF] Removing 0 grants
2019-12-30 21:55:41.720 +07:00 [INF] Removing 0 grants
2019-12-30 21:56:11.723 +07:00 [INF] Removing 0 grants
2019-12-30 21:56:41.727 +07:00 [INF] Removing 0 grants
2019-12-30 21:57:11.739 +07:00 [INF] Removing 0 grants
2019-12-30 21:57:41.756 +07:00 [INF] Removing 0 grants
2019-12-30 21:58:11.771 +07:00 [INF] Removing 0 grants
2019-12-30 21:58:41.791 +07:00 [INF] Removing 0 grants
2019-12-30 21:59:11.801 +07:00 [INF] Removing 0 grants
2019-12-30 21:59:41.817 +07:00 [INF] Removing 0 grants
2019-12-30 22:00:11.832 +07:00 [INF] Removing 0 grants
2019-12-30 22:00:41.848 +07:00 [INF] Removing 0 grants
2019-12-30 22:01:11.862 +07:00 [INF] Removing 0 grants
2019-12-30 22:01:41.867 +07:00 [INF] Removing 0 grants
2019-12-30 22:02:11.869 +07:00 [INF] Removing 0 grants
2019-12-30 22:02:41.883 +07:00 [INF] Removing 0 grants
2019-12-30 22:03:11.896 +07:00 [INF] Removing 0 grants
2019-12-30 22:03:41.910 +07:00 [INF] Removing 0 grants
2019-12-30 22:04:11.927 +07:00 [INF] Removing 0 grants
2019-12-30 22:04:41.929 +07:00 [INF] Removing 0 grants
2019-12-30 22:05:11.932 +07:00 [INF] Removing 0 grants
2019-12-30 22:05:41.941 +07:00 [INF] Removing 0 grants
2019-12-30 22:06:11.959 +07:00 [INF] Removing 0 grants
2019-12-30 22:06:41.973 +07:00 [INF] Removing 0 grants
2019-12-30 22:07:11.991 +07:00 [INF] Removing 0 grants
2019-12-30 22:07:42.006 +07:00 [INF] Removing 0 grants
2019-12-30 22:08:12.026 +07:00 [INF] Removing 0 grants
2019-12-30 22:08:42.037 +07:00 [INF] Removing 0 grants
2019-12-30 22:09:12.053 +07:00 [INF] Removing 0 grants
2019-12-30 22:09:42.068 +07:00 [INF] Removing 0 grants
2019-12-30 22:10:12.081 +07:00 [INF] Removing 0 grants
2019-12-30 22:10:42.098 +07:00 [INF] Removing 0 grants
2019-12-30 22:11:12.110 +07:00 [INF] Removing 0 grants
2019-12-30 22:11:42.114 +07:00 [INF] Removing 0 grants
2019-12-30 22:12:12.128 +07:00 [INF] Removing 0 grants
2019-12-30 22:12:42.149 +07:00 [INF] Removing 0 grants
2019-12-30 22:13:12.164 +07:00 [INF] Removing 0 grants
2019-12-30 22:13:42.178 +07:00 [INF] Removing 0 grants
2019-12-30 22:14:12.190 +07:00 [INF] Removing 0 grants
2019-12-30 22:14:42.192 +07:00 [INF] Removing 0 grants
2019-12-30 22:15:12.208 +07:00 [INF] Removing 0 grants
2019-12-30 22:15:42.225 +07:00 [INF] Removing 0 grants
2019-12-30 22:16:12.238 +07:00 [INF] Removing 0 grants
2019-12-30 22:16:42.238 +07:00 [INF] Removing 0 grants
2019-12-30 22:17:12.255 +07:00 [INF] Removing 0 grants
2019-12-30 22:17:42.271 +07:00 [INF] Removing 0 grants
2019-12-30 22:18:12.286 +07:00 [INF] Removing 0 grants
2019-12-30 22:18:42.301 +07:00 [INF] Removing 0 grants
2019-12-30 22:19:12.303 +07:00 [INF] Removing 0 grants
2019-12-30 22:19:42.315 +07:00 [INF] Removing 0 grants
2019-12-30 22:20:12.332 +07:00 [INF] Removing 0 grants
2019-12-30 22:20:42.347 +07:00 [INF] Removing 0 grants
2019-12-30 22:21:12.362 +07:00 [INF] Removing 0 grants
2019-12-30 22:21:42.365 +07:00 [INF] Removing 0 grants
2019-12-30 22:22:12.370 +07:00 [INF] Removing 0 grants
2019-12-30 22:22:42.385 +07:00 [INF] Removing 0 grants
2019-12-30 22:23:12.394 +07:00 [INF] Removing 0 grants
2019-12-30 22:23:42.396 +07:00 [INF] Removing 0 grants
2019-12-30 22:24:12.409 +07:00 [INF] Removing 0 grants
2019-12-30 22:24:42.411 +07:00 [INF] Removing 0 grants
2019-12-30 22:25:12.436 +07:00 [INF] Removing 0 grants
2019-12-30 22:25:42.453 +07:00 [INF] Removing 0 grants
2019-12-30 22:26:12.457 +07:00 [INF] Removing 0 grants
2019-12-30 22:26:42.472 +07:00 [INF] Removing 0 grants
2019-12-30 22:26:51.427 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 22:26:51.428 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 22:26:51.428 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 22:26:51.428 +07:00 [DBG] Start authorize request
2019-12-30 22:26:51.428 +07:00 [DBG] No user present in authorize request
2019-12-30 22:26:51.428 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 22:26:51.428 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 22:26:51.428 +07:00 [ERR] Invalid redirect_uri: http://localhost:4200/silent-refresh.html
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":null,"AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/silent-refresh.html","response_type":"id_token token","scope":"openid profile email api.read","state":"e2788f49978d4773bc4bdcf3e67c2306","nonce":"37eb5943ce274177af9fe0dcd11d688d","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 22:26:51.428 +07:00 [ERR] Request validation failed
2019-12-30 22:26:51.429 +07:00 [INF] {"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":null,"AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/silent-refresh.html","response_type":"id_token token","scope":"openid profile email api.read","state":"e2788f49978d4773bc4bdcf3e67c2306","nonce":"37eb5943ce274177af9fe0dcd11d688d","prompt":"none","id_token_hint":"***REDACTED***"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 22:26:51.466 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-30 22:26:51.466 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-30 22:26:51.466 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-30 22:26:51.466 +07:00 [DBG] Start authorize request
2019-12-30 22:26:51.467 +07:00 [DBG] No user present in authorize request
2019-12-30 22:26:51.467 +07:00 [DBG] Start authorize request protocol validation
2019-12-30 22:26:51.467 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-30 22:26:51.467 +07:00 [ERR] Invalid redirect_uri: http://localhost:4200/silent-refresh.html
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":null,"AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/silent-refresh.html","response_type":"id_token","scope":"openid","state":"f6ec1a8bebbb48f98ac80cad988c9fa0","nonce":"b52b32ec9e234f8a9be892b8aac63e85","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 22:26:51.467 +07:00 [ERR] Request validation failed
2019-12-30 22:26:51.467 +07:00 [INF] {"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":null,"AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":null,"ResponseMode":null,"GrantType":null,"RequestedScopes":"","State":null,"UiLocales":null,"Nonce":null,"AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/silent-refresh.html","response_type":"id_token","scope":"openid","state":"f6ec1a8bebbb48f98ac80cad988c9fa0","nonce":"b52b32ec9e234f8a9be892b8aac63e85","prompt":"none"},"$type":"AuthorizeRequestValidationLog"}
2019-12-30 22:27:12.487 +07:00 [INF] Removing 0 grants
2019-12-30 22:27:42.501 +07:00 [INF] Removing 0 grants
2019-12-30 22:28:12.505 +07:00 [INF] Removing 0 grants
2019-12-30 22:28:42.522 +07:00 [INF] Removing 0 grants
2019-12-30 22:29:12.536 +07:00 [INF] Removing 0 grants
2019-12-30 22:29:42.550 +07:00 [INF] Removing 0 grants
2019-12-30 22:30:12.567 +07:00 [INF] Removing 0 grants
2019-12-30 22:30:42.579 +07:00 [INF] Removing 0 grants
2019-12-30 22:31:12.596 +07:00 [INF] Removing 0 grants
2019-12-30 22:31:42.606 +07:00 [INF] Removing 0 grants
2019-12-30 22:32:12.613 +07:00 [INF] Removing 0 grants
2019-12-30 22:32:42.629 +07:00 [INF] Removing 0 grants
2019-12-30 22:33:12.643 +07:00 [INF] Removing 0 grants
2019-12-30 22:33:42.646 +07:00 [INF] Removing 0 grants
2019-12-30 22:34:12.660 +07:00 [INF] Removing 0 grants
2019-12-30 22:34:42.692 +07:00 [INF] Removing 0 grants
2019-12-30 22:35:12.709 +07:00 [INF] Removing 0 grants
2019-12-30 22:35:42.712 +07:00 [INF] Removing 0 grants
2019-12-30 22:36:12.726 +07:00 [INF] Removing 0 grants
2019-12-30 22:36:42.737 +07:00 [INF] Removing 0 grants
2019-12-30 22:37:12.739 +07:00 [INF] Removing 0 grants
2019-12-30 22:37:42.765 +07:00 [INF] Removing 0 grants
2019-12-30 22:38:12.768 +07:00 [INF] Removing 0 grants
2019-12-30 22:38:42.769 +07:00 [INF] Removing 0 grants
2019-12-31 12:28:58.134 +07:00 [INF] Removing 0 grants
2019-12-31 12:29:28.146 +07:00 [INF] Removing 0 grants
2019-12-31 12:29:58.158 +07:00 [INF] Removing 0 grants
2019-12-31 12:30:28.164 +07:00 [INF] Removing 0 grants
2019-12-31 12:30:58.175 +07:00 [INF] Removing 0 grants
2019-12-31 12:31:28.186 +07:00 [INF] Removing 0 grants
2019-12-31 12:31:58.194 +07:00 [INF] Removing 0 grants
2019-12-31 12:32:28.202 +07:00 [INF] Removing 0 grants
2019-12-31 12:32:58.210 +07:00 [INF] Removing 0 grants
2019-12-31 12:33:28.216 +07:00 [INF] Removing 0 grants
2019-12-31 12:33:58.219 +07:00 [INF] Removing 0 grants
2019-12-31 12:34:28.225 +07:00 [INF] Removing 0 grants
2019-12-31 12:34:58.239 +07:00 [INF] Removing 0 grants
2019-12-31 12:35:28.256 +07:00 [INF] Removing 0 grants
2019-12-31 12:35:58.258 +07:00 [INF] Removing 0 grants
2019-12-31 12:36:28.271 +07:00 [INF] Removing 0 grants
2019-12-31 12:36:58.276 +07:00 [INF] Removing 0 grants
2019-12-31 12:37:28.285 +07:00 [INF] Removing 0 grants
2019-12-31 12:37:58.293 +07:00 [INF] Removing 0 grants
2019-12-31 12:38:28.298 +07:00 [INF] Removing 0 grants
2019-12-31 12:38:58.317 +07:00 [INF] Removing 0 grants
2019-12-31 12:39:28.325 +07:00 [INF] Removing 0 grants
2019-12-31 12:39:58.328 +07:00 [INF] Removing 0 grants
2019-12-31 12:40:28.336 +07:00 [INF] Removing 0 grants
2019-12-31 12:40:58.350 +07:00 [INF] Removing 0 grants
2019-12-31 12:41:28.352 +07:00 [INF] Removing 0 grants
2019-12-31 12:41:58.356 +07:00 [INF] Removing 0 grants
2019-12-31 12:42:28.365 +07:00 [INF] Removing 0 grants
2019-12-31 12:42:58.374 +07:00 [INF] Removing 0 grants
2019-12-31 12:43:28.383 +07:00 [INF] Removing 0 grants
2019-12-31 12:43:58.388 +07:00 [INF] Removing 0 grants
2019-12-31 12:44:28.396 +07:00 [INF] Removing 0 grants
2019-12-31 12:44:58.405 +07:00 [INF] Removing 0 grants
2019-12-31 12:45:28.413 +07:00 [INF] Removing 0 grants
2019-12-31 12:45:58.418 +07:00 [INF] Removing 0 grants
2019-12-31 12:46:28.426 +07:00 [INF] Removing 0 grants
2019-12-31 12:46:58.428 +07:00 [INF] Removing 0 grants
2019-12-31 12:47:28.436 +07:00 [INF] Removing 0 grants
2019-12-31 12:47:58.446 +07:00 [INF] Removing 0 grants
2019-12-31 12:48:28.449 +07:00 [INF] Removing 0 grants
2019-12-31 12:48:58.457 +07:00 [INF] Removing 0 grants
2019-12-31 12:49:28.460 +07:00 [INF] Removing 0 grants
2019-12-31 12:49:58.463 +07:00 [INF] Removing 0 grants
2019-12-31 12:50:28.465 +07:00 [INF] Removing 0 grants
2019-12-31 12:50:58.475 +07:00 [INF] Removing 0 grants
2019-12-31 12:51:28.483 +07:00 [INF] Removing 0 grants
2019-12-31 12:51:58.527 +07:00 [INF] Removing 0 grants
2019-12-31 12:52:28.536 +07:00 [INF] Removing 0 grants
2019-12-31 12:52:58.561 +07:00 [INF] Removing 0 grants
2019-12-31 12:53:28.573 +07:00 [INF] Removing 0 grants
2019-12-31 12:53:58.582 +07:00 [INF] Removing 0 grants
2019-12-31 12:54:28.589 +07:00 [INF] Removing 0 grants
2019-12-31 12:54:58.597 +07:00 [INF] Removing 0 grants
2019-12-31 12:55:28.601 +07:00 [INF] Removing 0 grants
2019-12-31 12:55:58.617 +07:00 [INF] Removing 0 grants
2019-12-31 12:56:28.621 +07:00 [INF] Removing 0 grants
2019-12-31 12:56:35.914 +07:00 [DBG] TaskCanceledException. Exiting.
2019-12-31 12:56:36.105 +07:00 [DBG] Stopping grant removal
2019-12-31 22:18:37.425 +07:00 [INF] Starting IdentityServer4 version 2.4.0.0
2019-12-31 22:18:37.542 +07:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-12-31 22:18:37.542 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-12-31 22:18:37.542 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-12-31 22:18:37.542 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-12-31 22:18:37.542 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-12-31 22:18:37.542 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-12-31 22:18:37.902 +07:00 [DBG] Starting grant removal
2019-12-31 22:19:08.149 +07:00 [WRN] The LINQ expression 'where ([x].Expiration < Convert(DateTime.UtcNow, Nullable`1))' could not be translated and will be evaluated locally.
2019-12-31 22:19:08.162 +07:00 [WRN] The LINQ expression 'Take(__p_0)' could not be translated and will be evaluated locally.
2019-12-31 22:19:12.800 +07:00 [ERR] Failed executing DbCommand (213ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `x`.`Key`, `x`.`ClientId`, `x`.`CreationTime`, `x`.`Data`, `x`.`Expiration`, `x`.`SubjectId`, `x`.`Type`
FROM `PersistedGrants` AS `x`
ORDER BY `x`.`Key`
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AuthServer.PersistedGrants' doesn't exist
   at MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   at MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   at MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   at MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
2019-12-31 22:19:12.818 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'IdentityServer4.EntityFramework.DbContexts.PersistedGrantDbContext'.
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AuthServer.PersistedGrants' doesn't exist
   at MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   at MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   at MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   at MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext()
   at System.Linq.Enumerable.EnumerablePartition`1.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AuthServer.PersistedGrants' doesn't exist
   at MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   at MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   at MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   at MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext()
   at System.Linq.Enumerable.EnumerablePartition`1.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
2019-12-31 22:19:12.819 +07:00 [ERR] Exception removing expired grants: Table 'AuthServer.PersistedGrants' doesn't exist
2019-12-31 22:19:43.449 +07:00 [ERR] Failed executing DbCommand (205ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `x`.`Key`, `x`.`ClientId`, `x`.`CreationTime`, `x`.`Data`, `x`.`Expiration`, `x`.`SubjectId`, `x`.`Type`
FROM `PersistedGrants` AS `x`
ORDER BY `x`.`Key`
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AuthServer.PersistedGrants' doesn't exist
   at MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   at MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   at MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   at MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
2019-12-31 22:19:43.451 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'IdentityServer4.EntityFramework.DbContexts.PersistedGrantDbContext'.
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AuthServer.PersistedGrants' doesn't exist
   at MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   at MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   at MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   at MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext()
   at System.Linq.Enumerable.EnumerablePartition`1.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AuthServer.PersistedGrants' doesn't exist
   at MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   at MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   at MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   at MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext()
   at System.Linq.Enumerable.EnumerablePartition`1.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
2019-12-31 22:19:43.452 +07:00 [ERR] Exception removing expired grants: Table 'AuthServer.PersistedGrants' doesn't exist
2019-12-31 22:20:14.077 +07:00 [ERR] Failed executing DbCommand (206ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `x`.`Key`, `x`.`ClientId`, `x`.`CreationTime`, `x`.`Data`, `x`.`Expiration`, `x`.`SubjectId`, `x`.`Type`
FROM `PersistedGrants` AS `x`
ORDER BY `x`.`Key`
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AuthServer.PersistedGrants' doesn't exist
   at MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   at MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   at MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   at MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
2019-12-31 22:20:14.078 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'IdentityServer4.EntityFramework.DbContexts.PersistedGrantDbContext'.
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AuthServer.PersistedGrants' doesn't exist
   at MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   at MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   at MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   at MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext()
   at System.Linq.Enumerable.EnumerablePartition`1.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AuthServer.PersistedGrants' doesn't exist
   at MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   at MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   at MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   at MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext()
   at System.Linq.Enumerable.EnumerablePartition`1.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
2019-12-31 22:20:14.079 +07:00 [ERR] Exception removing expired grants: Table 'AuthServer.PersistedGrants' doesn't exist
2019-12-31 22:20:40.441 +07:00 [DBG] TaskCanceledException. Exiting.
2019-12-31 22:20:40.454 +07:00 [DBG] Stopping grant removal
2019-12-31 22:22:15.784 +07:00 [INF] Starting IdentityServer4 version 2.4.0.0
2019-12-31 22:22:15.883 +07:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-12-31 22:22:15.883 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-12-31 22:22:15.883 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-12-31 22:22:15.884 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-12-31 22:22:15.884 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-12-31 22:22:15.884 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-12-31 22:22:16.068 +07:00 [DBG] Starting grant removal
2019-12-31 22:22:46.277 +07:00 [WRN] The LINQ expression 'where ([x].Expiration < Convert(DateTime.UtcNow, Nullable`1))' could not be translated and will be evaluated locally.
2019-12-31 22:22:46.291 +07:00 [WRN] The LINQ expression 'Take(__p_0)' could not be translated and will be evaluated locally.
2019-12-31 22:22:50.471 +07:00 [INF] Removing 0 grants
2019-12-31 22:23:21.115 +07:00 [INF] Removing 0 grants
2019-12-31 22:23:51.741 +07:00 [INF] Removing 0 grants
2019-12-31 22:24:19.495 +07:00 [WRN] Failed to determine the https port for redirect.
2019-12-31 22:24:19.503 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-31 22:24:19.507 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-31 22:24:19.507 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-31 22:24:19.523 +07:00 [DBG] Login Url: /Account/Login
2019-12-31 22:24:19.524 +07:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-12-31 22:24:19.524 +07:00 [DBG] Logout Url: /Account/Logout
2019-12-31 22:24:19.524 +07:00 [DBG] ConsentUrl Url: /consent
2019-12-31 22:24:19.524 +07:00 [DBG] Consent Return Url Parameter: returnUrl
2019-12-31 22:24:19.524 +07:00 [DBG] Error Url: /home/error
2019-12-31 22:24:19.524 +07:00 [DBG] Error Id Parameter: errorId
2019-12-31 22:24:19.552 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-31 22:24:19.571 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-31 22:24:19.571 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-31 22:24:19.575 +07:00 [DBG] Start discovery request
2019-12-31 22:24:19.686 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-31 22:24:19.692 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-31 22:24:19.692 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-31 22:24:19.696 +07:00 [DBG] Start authorize request
2019-12-31 22:24:19.706 +07:00 [DBG] No user present in authorize request
2019-12-31 22:24:19.712 +07:00 [DBG] Start authorize request protocol validation
2019-12-31 22:24:19.737 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 22:24:19.789 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-31 22:24:19.817 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"2ce6e92d119b4da6974f14d46509bd82","UiLocales":null,"Nonce":"53815c2fc94b45d48fc8268eb7fbdfbf","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"2ce6e92d119b4da6974f14d46509bd82","nonce":"53815c2fc94b45d48fc8268eb7fbdfbf"},"$type":"AuthorizeRequestValidationLog"}
2019-12-31 22:24:19.827 +07:00 [INF] Showing login: User is not authenticated
2019-12-31 22:24:20.009 +07:00 [DBG] Start authorize request protocol validation
2019-12-31 22:24:20.010 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 22:24:20.010 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-31 22:24:20.014 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 22:24:22.352 +07:00 [DBG] Start authorize request protocol validation
2019-12-31 22:24:22.352 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 22:24:22.352 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-31 22:24:22.371 +07:00 [INF] Removing 0 grants
2019-12-31 22:24:22.395 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 22:24:22.399 +07:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-12-31 22:24:22.399 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-12-31 22:24:22.399 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-12-31 22:24:22.407 +07:00 [DBG] Start authorize callback request
2019-12-31 22:24:22.413 +07:00 [DBG] No user present in authorize request
2019-12-31 22:24:22.413 +07:00 [DBG] Start authorize request protocol validation
2019-12-31 22:24:22.413 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 22:24:22.413 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-31 22:24:22.413 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"2ce6e92d119b4da6974f14d46509bd82","UiLocales":null,"Nonce":"53815c2fc94b45d48fc8268eb7fbdfbf","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"2ce6e92d119b4da6974f14d46509bd82","nonce":"53815c2fc94b45d48fc8268eb7fbdfbf"},"$type":"AuthorizeRequestValidationLog"}
2019-12-31 22:24:22.413 +07:00 [INF] Error: User denied consent
2019-12-31 22:24:22.416 +07:00 [INF] {"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"2ce6e92d119b4da6974f14d46509bd82","UiLocales":null,"Nonce":"53815c2fc94b45d48fc8268eb7fbdfbf","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"2ce6e92d119b4da6974f14d46509bd82","nonce":"53815c2fc94b45d48fc8268eb7fbdfbf"},"$type":"AuthorizeRequestValidationLog"}
2019-12-31 22:24:36.418 +07:00 [DBG] CORS request made for path: /api/account from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-12-31 22:24:37.290 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'AuthServer.Infrastructure.Data.Identity.AppIdentityDbContext'.
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
2019-12-31 22:24:37.297 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'AuthServer.Infrastructure.Data.Identity.AppIdentityDbContext'.
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
2019-12-31 22:24:37.332 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
   at Microsoft.AspNetCore.Identity.UserManager`1.FindByNameAsync(String userName)
   at Microsoft.AspNetCore.Identity.UserValidator`1.ValidateUserName(UserManager`1 manager, TUser user, ICollection`1 errors)
   at Microsoft.AspNetCore.Identity.UserValidator`1.ValidateAsync(UserManager`1 manager, TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.ValidateUserAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user, String password)
   at AuthServer.Controllers.AccountController.Register(RegisterRequestViewModel model) in D:\MyGitHub\sso-server\Controllers\AccountController.cs:line 166
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.Invoke(HttpContext context)
2019-12-31 22:24:53.017 +07:00 [INF] Removing 0 grants
2019-12-31 22:25:23.652 +07:00 [INF] Removing 0 grants
2019-12-31 22:25:54.284 +07:00 [INF] Removing 0 grants
2019-12-31 22:26:27.318 +07:00 [INF] Removing 0 grants
2019-12-31 22:26:57.952 +07:00 [INF] Removing 0 grants
2019-12-31 22:27:28.584 +07:00 [INF] Removing 0 grants
2019-12-31 22:27:59.423 +07:00 [INF] Removing 0 grants
2019-12-31 22:28:30.054 +07:00 [INF] Removing 0 grants
2019-12-31 22:29:00.690 +07:00 [INF] Removing 0 grants
2019-12-31 22:29:31.324 +07:00 [INF] Removing 0 grants
2019-12-31 22:30:01.965 +07:00 [INF] Removing 0 grants
2019-12-31 22:30:32.595 +07:00 [INF] Removing 0 grants
2019-12-31 22:31:07.293 +07:00 [INF] Removing 0 grants
2019-12-31 22:31:37.923 +07:00 [INF] Removing 0 grants
2019-12-31 22:32:08.557 +07:00 [INF] Removing 0 grants
2019-12-31 22:32:39.182 +07:00 [INF] Removing 0 grants
2019-12-31 22:33:09.817 +07:00 [INF] Removing 0 grants
2019-12-31 22:33:40.448 +07:00 [INF] Removing 0 grants
2019-12-31 22:34:11.111 +07:00 [INF] Removing 0 grants
2019-12-31 22:34:41.738 +07:00 [INF] Removing 0 grants
2019-12-31 22:35:12.382 +07:00 [INF] Removing 0 grants
2019-12-31 22:35:43.042 +07:00 [INF] Removing 0 grants
2019-12-31 22:36:13.675 +07:00 [INF] Removing 0 grants
2019-12-31 22:36:46.333 +07:00 [INF] Removing 0 grants
2019-12-31 22:37:16.958 +07:00 [INF] Removing 0 grants
2019-12-31 22:37:47.599 +07:00 [INF] Removing 0 grants
2019-12-31 22:38:18.234 +07:00 [INF] Removing 0 grants
2019-12-31 22:38:48.862 +07:00 [INF] Removing 0 grants
2019-12-31 22:39:19.489 +07:00 [INF] Removing 0 grants
2019-12-31 22:39:50.120 +07:00 [INF] Removing 0 grants
2019-12-31 22:40:20.753 +07:00 [INF] Removing 0 grants
2019-12-31 22:40:51.380 +07:00 [INF] Removing 0 grants
2019-12-31 22:41:22.003 +07:00 [INF] Removing 0 grants
2019-12-31 22:41:52.637 +07:00 [INF] Removing 0 grants
2019-12-31 22:42:23.344 +07:00 [INF] Removing 0 grants
2019-12-31 22:42:53.976 +07:00 [INF] Removing 0 grants
2019-12-31 22:43:24.624 +07:00 [ERR] Failed executing DbCommand (213ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `x`.`Key`, `x`.`ClientId`, `x`.`CreationTime`, `x`.`Data`, `x`.`Expiration`, `x`.`SubjectId`, `x`.`Type`
FROM `PersistedGrants` AS `x`
ORDER BY `x`.`Key`
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AuthServer.PersistedGrants' doesn't exist
   at MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   at MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   at MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   at MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
2019-12-31 22:43:24.627 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'IdentityServer4.EntityFramework.DbContexts.PersistedGrantDbContext'.
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AuthServer.PersistedGrants' doesn't exist
   at MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   at MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   at MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   at MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext()
   at System.Linq.Enumerable.EnumerablePartition`1.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AuthServer.PersistedGrants' doesn't exist
   at MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   at MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   at MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   at MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext()
   at System.Linq.Enumerable.EnumerablePartition`1.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
2019-12-31 22:43:24.628 +07:00 [ERR] Exception removing expired grants: Table 'AuthServer.PersistedGrants' doesn't exist
2019-12-31 22:43:55.263 +07:00 [ERR] Failed executing DbCommand (207ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `x`.`Key`, `x`.`ClientId`, `x`.`CreationTime`, `x`.`Data`, `x`.`Expiration`, `x`.`SubjectId`, `x`.`Type`
FROM `PersistedGrants` AS `x`
ORDER BY `x`.`Key`
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AuthServer.PersistedGrants' doesn't exist
   at MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   at MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   at MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   at MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
2019-12-31 22:43:55.264 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'IdentityServer4.EntityFramework.DbContexts.PersistedGrantDbContext'.
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AuthServer.PersistedGrants' doesn't exist
   at MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   at MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   at MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   at MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext()
   at System.Linq.Enumerable.EnumerablePartition`1.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AuthServer.PersistedGrants' doesn't exist
   at MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   at MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   at MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   at MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext()
   at System.Linq.Enumerable.EnumerablePartition`1.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
2019-12-31 22:43:55.265 +07:00 [ERR] Exception removing expired grants: Table 'AuthServer.PersistedGrants' doesn't exist
2019-12-31 22:44:25.897 +07:00 [ERR] Failed executing DbCommand (207ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT `x`.`Key`, `x`.`ClientId`, `x`.`CreationTime`, `x`.`Data`, `x`.`Expiration`, `x`.`SubjectId`, `x`.`Type`
FROM `PersistedGrants` AS `x`
ORDER BY `x`.`Key`
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AuthServer.PersistedGrants' doesn't exist
   at MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   at MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   at MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   at MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
2019-12-31 22:44:25.898 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'IdentityServer4.EntityFramework.DbContexts.PersistedGrantDbContext'.
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AuthServer.PersistedGrants' doesn't exist
   at MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   at MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   at MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   at MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext()
   at System.Linq.Enumerable.EnumerablePartition`1.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
MySql.Data.MySqlClient.MySqlException (0x80004005): Table 'AuthServer.PersistedGrants' doesn't exist
   at MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   at MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   at MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   at MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(DbContext _, Boolean buffer)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at System.Linq.Enumerable.WhereEnumerableIterator`1.MoveNext()
   at System.Linq.Enumerable.EnumerablePartition`1.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider._TrackEntities[TOut,TIn](IEnumerable`1 results, QueryContext queryContext, IList`1 entityTrackingInfos, IList`1 entityAccessors)+MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
2019-12-31 22:44:25.899 +07:00 [ERR] Exception removing expired grants: Table 'AuthServer.PersistedGrants' doesn't exist
2019-12-31 22:44:40.443 +07:00 [DBG] TaskCanceledException. Exiting.
2019-12-31 22:44:40.523 +07:00 [DBG] Stopping grant removal
2019-12-31 22:47:05.164 +07:00 [INF] Starting IdentityServer4 version 2.4.0.0
2019-12-31 22:47:05.527 +07:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-12-31 22:47:05.527 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-12-31 22:47:05.527 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-12-31 22:47:05.527 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-12-31 22:47:05.527 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-12-31 22:47:05.528 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-12-31 22:47:05.732 +07:00 [DBG] Starting grant removal
2019-12-31 22:47:14.041 +07:00 [WRN] Failed to determine the https port for redirect.
2019-12-31 22:47:14.055 +07:00 [DBG] CORS request made for path: /api/account from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-12-31 22:47:14.071 +07:00 [DBG] Login Url: /Account/Login
2019-12-31 22:47:14.071 +07:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-12-31 22:47:14.071 +07:00 [DBG] Logout Url: /Account/Logout
2019-12-31 22:47:14.071 +07:00 [DBG] ConsentUrl Url: /consent
2019-12-31 22:47:14.071 +07:00 [DBG] Consent Return Url Parameter: returnUrl
2019-12-31 22:47:14.071 +07:00 [DBG] Error Url: /home/error
2019-12-31 22:47:14.072 +07:00 [DBG] Error Id Parameter: errorId
2019-12-31 22:47:18.548 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'AuthServer.Infrastructure.Data.Identity.AppIdentityDbContext'.
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
2019-12-31 22:47:18.555 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'AuthServer.Infrastructure.Data.Identity.AppIdentityDbContext'.
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
2019-12-31 22:47:18.590 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
   at Microsoft.AspNetCore.Identity.UserManager`1.FindByNameAsync(String userName)
   at Microsoft.AspNetCore.Identity.UserValidator`1.ValidateUserName(UserManager`1 manager, TUser user, ICollection`1 errors)
   at Microsoft.AspNetCore.Identity.UserValidator`1.ValidateAsync(UserManager`1 manager, TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.ValidateUserAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user, String password)
   at AuthServer.Controllers.AccountController.Register(RegisterRequestViewModel model) in D:\MyGitHub\sso-server\Controllers\AccountController.cs:line 166
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.Invoke(HttpContext context)
2019-12-31 22:47:24.451 +07:00 [DBG] CORS request made for path: /api/account from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-12-31 22:47:25.101 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'AuthServer.Infrastructure.Data.Identity.AppIdentityDbContext'.
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
2019-12-31 22:47:25.108 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'AuthServer.Infrastructure.Data.Identity.AppIdentityDbContext'.
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
2019-12-31 22:47:25.115 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
   at Microsoft.AspNetCore.Identity.UserManager`1.FindByNameAsync(String userName)
   at Microsoft.AspNetCore.Identity.UserValidator`1.ValidateUserName(UserManager`1 manager, TUser user, ICollection`1 errors)
   at Microsoft.AspNetCore.Identity.UserValidator`1.ValidateAsync(UserManager`1 manager, TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.ValidateUserAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user, String password)
   at AuthServer.Controllers.AccountController.Register(RegisterRequestViewModel model) in D:\MyGitHub\sso-server\Controllers\AccountController.cs:line 166
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.Invoke(HttpContext context)
2019-12-31 22:47:35.777 +07:00 [WRN] The LINQ expression 'where ([x].Expiration < Convert(DateTime.UtcNow, Nullable`1))' could not be translated and will be evaluated locally.
2019-12-31 22:47:35.783 +07:00 [WRN] The LINQ expression 'Take(__p_0)' could not be translated and will be evaluated locally.
2019-12-31 22:47:36.425 +07:00 [INF] Removing 0 grants
2019-12-31 22:48:04.070 +07:00 [DBG] TaskCanceledException. Exiting.
2019-12-31 22:48:04.140 +07:00 [DBG] Stopping grant removal
2019-12-31 22:48:58.905 +07:00 [INF] Starting IdentityServer4 version 2.4.0.0
2019-12-31 22:48:59.039 +07:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-12-31 22:48:59.061 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-12-31 22:48:59.061 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-12-31 22:48:59.062 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-12-31 22:48:59.062 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-12-31 22:48:59.062 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-12-31 22:48:59.261 +07:00 [DBG] Starting grant removal
2019-12-31 22:49:21.085 +07:00 [WRN] Failed to determine the https port for redirect.
2019-12-31 22:49:21.100 +07:00 [DBG] CORS request made for path: /api/account from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-12-31 22:49:21.120 +07:00 [DBG] Login Url: /Account/Login
2019-12-31 22:49:21.120 +07:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-12-31 22:49:21.120 +07:00 [DBG] Logout Url: /Account/Logout
2019-12-31 22:49:21.120 +07:00 [DBG] ConsentUrl Url: /consent
2019-12-31 22:49:21.121 +07:00 [DBG] Consent Return Url Parameter: returnUrl
2019-12-31 22:49:21.121 +07:00 [DBG] Error Url: /home/error
2019-12-31 22:49:21.121 +07:00 [DBG] Error Id Parameter: errorId
2019-12-31 22:49:25.573 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'AuthServer.Infrastructure.Data.Identity.AppIdentityDbContext'.
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
2019-12-31 22:49:25.580 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'AuthServer.Infrastructure.Data.Identity.AppIdentityDbContext'.
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
2019-12-31 22:49:25.633 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
   at Microsoft.AspNetCore.Identity.UserManager`1.FindByNameAsync(String userName)
   at Microsoft.AspNetCore.Identity.UserValidator`1.ValidateUserName(UserManager`1 manager, TUser user, ICollection`1 errors)
   at Microsoft.AspNetCore.Identity.UserValidator`1.ValidateAsync(UserManager`1 manager, TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.ValidateUserAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user, String password)
   at AuthServer.Controllers.AccountController.Register(RegisterRequestViewModel model) in D:\MyGitHub\sso-server\Controllers\AccountController.cs:line 166
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.Invoke(HttpContext context)
2019-12-31 22:49:29.333 +07:00 [WRN] The LINQ expression 'where ([x].Expiration < Convert(DateTime.UtcNow, Nullable`1))' could not be translated and will be evaluated locally.
2019-12-31 22:49:29.340 +07:00 [WRN] The LINQ expression 'Take(__p_0)' could not be translated and will be evaluated locally.
2019-12-31 22:49:29.982 +07:00 [INF] Removing 0 grants
2019-12-31 22:50:00.694 +07:00 [INF] Removing 0 grants
2019-12-31 22:50:31.331 +07:00 [INF] Removing 0 grants
2019-12-31 22:51:01.971 +07:00 [INF] Removing 0 grants
2019-12-31 22:51:32.609 +07:00 [INF] Removing 0 grants
2019-12-31 22:52:03.248 +07:00 [INF] Removing 0 grants
2019-12-31 22:52:33.884 +07:00 [INF] Removing 0 grants
2019-12-31 22:53:04.545 +07:00 [INF] Removing 0 grants
2019-12-31 22:53:35.202 +07:00 [INF] Removing 0 grants
2019-12-31 22:54:05.847 +07:00 [INF] Removing 0 grants
2019-12-31 22:54:36.480 +07:00 [INF] Removing 0 grants
2019-12-31 22:55:07.110 +07:00 [INF] Removing 0 grants
2019-12-31 22:55:37.747 +07:00 [INF] Removing 0 grants
2019-12-31 22:56:08.377 +07:00 [INF] Removing 0 grants
2019-12-31 22:56:39.021 +07:00 [INF] Removing 0 grants
2019-12-31 22:57:09.730 +07:00 [INF] Removing 0 grants
2019-12-31 22:57:40.388 +07:00 [INF] Removing 0 grants
2019-12-31 22:58:11.029 +07:00 [INF] Removing 0 grants
2019-12-31 22:58:41.670 +07:00 [INF] Removing 0 grants
2019-12-31 22:58:54.522 +07:00 [DBG] TaskCanceledException. Exiting.
2019-12-31 22:58:54.533 +07:00 [DBG] Stopping grant removal
2019-12-31 23:01:07.422 +07:00 [INF] Starting IdentityServer4 version 2.4.0.0
2019-12-31 23:01:07.510 +07:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-12-31 23:01:07.510 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-12-31 23:01:07.510 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-12-31 23:01:07.510 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-12-31 23:01:07.510 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-12-31 23:01:07.510 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-12-31 23:01:07.651 +07:00 [DBG] Starting grant removal
2019-12-31 23:01:18.737 +07:00 [WRN] Failed to determine the https port for redirect.
2019-12-31 23:01:18.752 +07:00 [DBG] CORS request made for path: /api/account from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-12-31 23:01:18.767 +07:00 [DBG] Login Url: /Account/Login
2019-12-31 23:01:18.767 +07:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-12-31 23:01:18.767 +07:00 [DBG] Logout Url: /Account/Logout
2019-12-31 23:01:18.767 +07:00 [DBG] ConsentUrl Url: /consent
2019-12-31 23:01:18.767 +07:00 [DBG] Consent Return Url Parameter: returnUrl
2019-12-31 23:01:18.767 +07:00 [DBG] Error Url: /home/error
2019-12-31 23:01:18.767 +07:00 [DBG] Error Id Parameter: errorId
2019-12-31 23:01:31.479 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'AuthServer.Infrastructure.Data.Identity.AppIdentityDbContext'.
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
2019-12-31 23:01:31.485 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'AuthServer.Infrastructure.Data.Identity.AppIdentityDbContext'.
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
2019-12-31 23:01:31.564 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
   at Microsoft.AspNetCore.Identity.UserManager`1.FindByNameAsync(String userName)
   at Microsoft.AspNetCore.Identity.UserValidator`1.ValidateUserName(UserManager`1 manager, TUser user, ICollection`1 errors)
   at Microsoft.AspNetCore.Identity.UserValidator`1.ValidateAsync(UserManager`1 manager, TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.ValidateUserAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user, String password)
   at AuthServer.Controllers.AccountController.Register(RegisterRequestViewModel model) in D:\MyGitHub\sso-server\Controllers\AccountController.cs:line 166
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.Invoke(HttpContext context)
2019-12-31 23:01:37.698 +07:00 [WRN] The LINQ expression 'where ([x].Expiration < Convert(DateTime.UtcNow, Nullable`1))' could not be translated and will be evaluated locally.
2019-12-31 23:01:37.709 +07:00 [WRN] The LINQ expression 'Take(__p_0)' could not be translated and will be evaluated locally.
2019-12-31 23:01:38.725 +07:00 [INF] Removing 0 grants
2019-12-31 23:02:09.513 +07:00 [INF] Removing 0 grants
2019-12-31 23:02:42.793 +07:00 [INF] Removing 0 grants
2019-12-31 23:03:14.596 +07:00 [INF] Removing 0 grants
2019-12-31 23:03:42.485 +07:00 [DBG] TaskCanceledException. Exiting.
2019-12-31 23:03:42.499 +07:00 [DBG] Stopping grant removal
2019-12-31 23:12:49.747 +07:00 [INF] Starting IdentityServer4 version 2.4.0.0
2019-12-31 23:12:50.046 +07:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-12-31 23:12:50.047 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-12-31 23:12:50.049 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-12-31 23:12:50.050 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-12-31 23:12:50.072 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-12-31 23:12:50.074 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-12-31 23:12:50.519 +07:00 [DBG] Starting grant removal
2019-12-31 23:13:20.892 +07:00 [WRN] Failed to determine the https port for redirect.
2019-12-31 23:13:20.892 +07:00 [WRN] The LINQ expression 'where ([x].Expiration < Convert(DateTime.UtcNow, Nullable`1))' could not be translated and will be evaluated locally.
2019-12-31 23:13:20.902 +07:00 [DBG] CORS request made for path: /api/account from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-12-31 23:13:20.907 +07:00 [WRN] The LINQ expression 'Take(__p_0)' could not be translated and will be evaluated locally.
2019-12-31 23:13:20.920 +07:00 [DBG] Login Url: /Account/Login
2019-12-31 23:13:20.921 +07:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-12-31 23:13:20.922 +07:00 [DBG] Logout Url: /Account/Logout
2019-12-31 23:13:20.923 +07:00 [DBG] ConsentUrl Url: /consent
2019-12-31 23:13:20.925 +07:00 [DBG] Consent Return Url Parameter: returnUrl
2019-12-31 23:13:20.926 +07:00 [DBG] Error Url: /home/error
2019-12-31 23:13:20.929 +07:00 [DBG] Error Id Parameter: errorId
2019-12-31 23:14:08.550 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'AuthServer.Infrastructure.Data.Identity.AppIdentityDbContext'.
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
2019-12-31 23:14:08.570 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'AuthServer.Infrastructure.Data.Identity.AppIdentityDbContext'.
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
2019-12-31 23:14:08.736 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: No coercion operator is defined between types 'System.Int16' and 'System.Boolean'.
   at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type, MethodInfo method)
   at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateGetValueExpression(Expression dataReaderExpression, Int32 index, TypeMaterializationInfo materializationInfo, Boolean detailedErrorsEnabled, Boolean box)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<>c__DisplayClass13_0.<CreateArrayInitializer>b__0(TypeMaterializationInfo mi, Int32 i)
   at System.Linq.Enumerable.SelectIterator[TSource,TResult](IEnumerable`1 source, Func`3 selector)+MoveNext()
   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)
   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)
   at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 source)
   at System.Dynamic.Utils.CollectionExtensions.ToReadOnly[T](IEnumerable`1 enumerable)
   at System.Linq.Expressions.Expression.NewArrayInit(Type type, IEnumerable`1 initializers)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.CreateArrayInitializer(CacheKey cacheKey, Boolean detailedErrorsEnabled)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.<Create>b__11_0(CacheKey k)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Storage.TypedRelationalValueBufferFactoryFactory.Create(IReadOnlyList`1 types)
   at Microsoft.EntityFrameworkCore.Query.Sql.DefaultQuerySqlGenerator.CreateValueBufferFactory(IRelationalValueBufferFactoryFactory relationalValueBufferFactoryFactory, DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.<NotifyReaderCreated>b__14_0(FactoryAndReader s)
   at Microsoft.EntityFrameworkCore.Internal.NonCapturingLazyInitializer.EnsureInitialized[TParam,TValue](TValue& target, TParam param, Func`2 valueFactory)
   at Microsoft.EntityFrameworkCore.Query.Internal.ShaperCommandContext.NotifyReaderCreated(DbDataReader dataReader)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.BufferlessMoveNext(DbContext _, Boolean buffer, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncQueryingEnumerable`1.AsyncEnumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.FirstOrDefault_[TSource](IAsyncEnumerable`1 source, CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\First.cs:line 144
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.TaskResultAsyncEnumerable`1.Enumerator.MoveNext(CancellationToken cancellationToken)
   at System.Linq.AsyncEnumerable.SelectEnumerableAsyncIterator`2.MoveNextCore(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\Select.cs:line 106
   at System.Linq.AsyncEnumerable.AsyncIterator`1.MoveNext(CancellationToken cancellationToken) in D:\a\1\s\Ix.NET\Source\System.Interactive.Async\AsyncIterator.cs:line 98
   at Microsoft.EntityFrameworkCore.Query.Internal.AsyncLinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteSingletonAsyncQuery[TResult](QueryContext queryContext, Func`2 compiledQuery, IDiagnosticsLogger`1 logger, Type contextType)
   at Microsoft.AspNetCore.Identity.UserManager`1.FindByNameAsync(String userName)
   at Microsoft.AspNetCore.Identity.UserValidator`1.ValidateUserName(UserManager`1 manager, TUser user, ICollection`1 errors)
   at Microsoft.AspNetCore.Identity.UserValidator`1.ValidateAsync(UserManager`1 manager, TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.ValidateUserAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.CreateAsync(TUser user, String password)
   at AuthServer.Controllers.AccountController.Register(RegisterRequestViewModel model) in d:\MyGitHub\sso-server\Controllers\AccountController.cs:line 166
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.Invoke(HttpContext context)
2019-12-31 23:14:08.884 +07:00 [INF] Removing 0 grants
2019-12-31 23:14:59.404 +07:00 [INF] Removing 0 grants
2019-12-31 23:15:30.046 +07:00 [INF] Removing 0 grants
2019-12-31 23:16:00.665 +07:00 [INF] Removing 0 grants
2019-12-31 23:16:31.315 +07:00 [INF] Removing 0 grants
2019-12-31 23:17:01.931 +07:00 [INF] Removing 0 grants
2019-12-31 23:17:32.571 +07:00 [INF] Removing 0 grants
2019-12-31 23:18:03.238 +07:00 [INF] Removing 0 grants
2019-12-31 23:18:33.883 +07:00 [INF] Removing 0 grants
2019-12-31 23:19:04.511 +07:00 [INF] Removing 0 grants
2019-12-31 23:19:35.154 +07:00 [INF] Removing 0 grants
2019-12-31 23:20:05.781 +07:00 [INF] Removing 0 grants
2019-12-31 23:20:36.418 +07:00 [INF] Removing 0 grants
2019-12-31 23:24:48.200 +07:00 [INF] Starting IdentityServer4 version 2.4.0.0
2019-12-31 23:24:48.342 +07:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-12-31 23:24:48.343 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-12-31 23:24:48.343 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-12-31 23:24:48.343 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-12-31 23:24:48.343 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-12-31 23:24:48.343 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-12-31 23:24:48.498 +07:00 [DBG] Starting grant removal
2019-12-31 23:25:11.425 +07:00 [WRN] Failed to determine the https port for redirect.
2019-12-31 23:25:11.439 +07:00 [DBG] CORS request made for path: /api/account from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-12-31 23:25:11.453 +07:00 [DBG] Login Url: /Account/Login
2019-12-31 23:25:11.454 +07:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-12-31 23:25:11.454 +07:00 [DBG] Logout Url: /Account/Logout
2019-12-31 23:25:11.454 +07:00 [DBG] ConsentUrl Url: /consent
2019-12-31 23:25:11.454 +07:00 [DBG] Consent Return Url Parameter: returnUrl
2019-12-31 23:25:11.454 +07:00 [DBG] Error Url: /home/error
2019-12-31 23:25:11.454 +07:00 [DBG] Error Id Parameter: errorId
2019-12-31 23:25:17.215 +07:00 [ERR] Failed executing DbCommand (208ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `AspNetUserClaims` (`ClaimType`, `ClaimValue`, `UserId`)
VALUES (@p0, @p1, @p2);
SELECT `Id`
FROM `AspNetUserClaims`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
MySql.Data.MySqlClient.MySqlException (0x80004005): Field 'Id' doesn't have a default value ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Field 'Id' doesn't have a default value
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
2019-12-31 23:25:17.439 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'AuthServer.Infrastructure.Data.Identity.AppIdentityDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   --- End of inner exception stack trace ---
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   --- End of inner exception stack trace ---
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2019-12-31 23:25:17.487 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   --- End of inner exception stack trace ---
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore`9.UpdateAsync(TUser user, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.UserManager`1.UpdateUserAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.AddClaimsAsync(TUser user, IEnumerable`1 claims)
   at AuthServer.Controllers.AccountController.Register(RegisterRequestViewModel model) in D:\MyGitHub\sso-server\Controllers\AccountController.cs:line 170
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.Invoke(HttpContext context)
2019-12-31 23:25:19.188 +07:00 [INF] Removing 0 grants
2019-12-31 23:25:49.823 +07:00 [INF] Removing 0 grants
2019-12-31 23:26:20.444 +07:00 [INF] Removing 0 grants
2019-12-31 23:26:51.073 +07:00 [INF] Removing 0 grants
2019-12-31 23:27:21.703 +07:00 [INF] Removing 0 grants
2019-12-31 23:27:52.336 +07:00 [INF] Removing 0 grants
2019-12-31 23:28:24.296 +07:00 [INF] Removing 0 grants
2019-12-31 23:28:54.923 +07:00 [INF] Removing 0 grants
2019-12-31 23:29:25.553 +07:00 [INF] Removing 0 grants
2019-12-31 23:29:56.191 +07:00 [INF] Removing 0 grants
2019-12-31 23:30:26.827 +07:00 [INF] Removing 0 grants
2019-12-31 23:30:57.548 +07:00 [INF] Removing 0 grants
2019-12-31 23:31:28.177 +07:00 [INF] Removing 0 grants
2019-12-31 23:31:58.802 +07:00 [INF] Removing 0 grants
2019-12-31 23:32:29.429 +07:00 [INF] Removing 0 grants
2019-12-31 23:33:00.053 +07:00 [INF] Removing 0 grants
2019-12-31 23:33:11.557 +07:00 [DBG] CORS request made for path: /api/account from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-12-31 23:33:14.738 +07:00 [ERR] Failed executing DbCommand (206ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `AspNetUserClaims` (`ClaimType`, `ClaimValue`, `UserId`)
VALUES (@p0, @p1, @p2);
SELECT `Id`
FROM `AspNetUserClaims`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
MySql.Data.MySqlClient.MySqlException (0x80004005): Field 'Id' doesn't have a default value ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Field 'Id' doesn't have a default value
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
2019-12-31 23:33:14.950 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'AuthServer.Infrastructure.Data.Identity.AppIdentityDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   --- End of inner exception stack trace ---
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   --- End of inner exception stack trace ---
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2019-12-31 23:33:14.955 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   --- End of inner exception stack trace ---
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore`9.UpdateAsync(TUser user, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.UserManager`1.UpdateUserAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.AddClaimsAsync(TUser user, IEnumerable`1 claims)
   at AuthServer.Controllers.AccountController.Register(RegisterRequestViewModel model) in D:\MyGitHub\sso-server\Controllers\AccountController.cs:line 170
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.Invoke(HttpContext context)
2019-12-31 23:33:30.683 +07:00 [INF] Removing 0 grants
2019-12-31 23:33:37.742 +07:00 [DBG] TaskCanceledException. Exiting.
2019-12-31 23:33:37.787 +07:00 [DBG] Stopping grant removal
2019-12-31 23:33:41.854 +07:00 [INF] Starting IdentityServer4 version 2.4.0.0
2019-12-31 23:33:41.965 +07:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-12-31 23:33:41.965 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-12-31 23:33:41.965 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-12-31 23:33:41.965 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-12-31 23:33:41.965 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-12-31 23:33:41.965 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-12-31 23:33:42.105 +07:00 [DBG] Starting grant removal
2019-12-31 23:33:48.890 +07:00 [WRN] Failed to determine the https port for redirect.
2019-12-31 23:33:48.904 +07:00 [DBG] CORS request made for path: /api/account from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-12-31 23:33:48.919 +07:00 [DBG] Login Url: /Account/Login
2019-12-31 23:33:48.919 +07:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-12-31 23:33:48.919 +07:00 [DBG] Logout Url: /Account/Logout
2019-12-31 23:33:48.919 +07:00 [DBG] ConsentUrl Url: /consent
2019-12-31 23:33:48.919 +07:00 [DBG] Consent Return Url Parameter: returnUrl
2019-12-31 23:33:48.919 +07:00 [DBG] Error Url: /home/error
2019-12-31 23:33:48.919 +07:00 [DBG] Error Id Parameter: errorId
2019-12-31 23:33:52.103 +07:00 [WRN] User f61da831-206d-4c86-9c49-674e354b7b4e validation failed: DuplicateUserName.
2019-12-31 23:34:13.069 +07:00 [INF] Removing 0 grants
2019-12-31 23:34:21.970 +07:00 [DBG] CORS request made for path: /api/account from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-12-31 23:34:25.251 +07:00 [ERR] Failed executing DbCommand (208ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `AspNetUserClaims` (`ClaimType`, `ClaimValue`, `UserId`)
VALUES (@p0, @p1, @p2);
SELECT `Id`
FROM `AspNetUserClaims`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
MySql.Data.MySqlClient.MySqlException (0x80004005): Field 'Id' doesn't have a default value ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Field 'Id' doesn't have a default value
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
2019-12-31 23:34:25.464 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'AuthServer.Infrastructure.Data.Identity.AppIdentityDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   --- End of inner exception stack trace ---
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   --- End of inner exception stack trace ---
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2019-12-31 23:34:25.481 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   --- End of inner exception stack trace ---
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore`9.UpdateAsync(TUser user, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.UserManager`1.UpdateUserAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.AddClaimsAsync(TUser user, IEnumerable`1 claims)
   at AuthServer.Controllers.AccountController.Register(RegisterRequestViewModel model) in D:\MyGitHub\sso-server\Controllers\AccountController.cs:line 170
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.Invoke(HttpContext context)
2019-12-31 23:34:43.709 +07:00 [INF] Removing 0 grants
2019-12-31 23:35:14.549 +07:00 [INF] Removing 0 grants
2019-12-31 23:35:45.173 +07:00 [INF] Removing 0 grants
2019-12-31 23:36:15.788 +07:00 [INF] Removing 0 grants
2019-12-31 23:36:15.926 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-31 23:36:15.933 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-31 23:36:15.933 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-31 23:36:15.934 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-31 23:36:15.939 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-31 23:36:15.939 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-31 23:36:15.945 +07:00 [DBG] Start discovery request
2019-12-31 23:36:16.041 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-31 23:36:16.044 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-31 23:36:16.044 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-31 23:36:16.051 +07:00 [DBG] Start authorize request
2019-12-31 23:36:16.065 +07:00 [DBG] No user present in authorize request
2019-12-31 23:36:16.072 +07:00 [DBG] Start authorize request protocol validation
2019-12-31 23:36:16.095 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 23:36:16.150 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-31 23:36:16.175 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"ffdda0f863fc408ca1b09c11bfc66f2c","UiLocales":null,"Nonce":"429a72007739418d8efc578286559369","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"ffdda0f863fc408ca1b09c11bfc66f2c","nonce":"429a72007739418d8efc578286559369"},"$type":"AuthorizeRequestValidationLog"}
2019-12-31 23:36:16.189 +07:00 [INF] Showing login: User is not authenticated
2019-12-31 23:36:16.223 +07:00 [DBG] Start authorize request protocol validation
2019-12-31 23:36:16.223 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 23:36:16.223 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-31 23:36:16.225 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 23:36:24.266 +07:00 [DBG] Start authorize request protocol validation
2019-12-31 23:36:24.266 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 23:36:24.266 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-31 23:36:24.884 +07:00 [DBG] Start authorize request protocol validation
2019-12-31 23:36:24.884 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 23:36:24.885 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-31 23:36:24.885 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 23:36:31.954 +07:00 [DBG] Start authorize request protocol validation
2019-12-31 23:36:31.954 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 23:36:31.954 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-31 23:36:32.576 +07:00 [DBG] Start authorize request protocol validation
2019-12-31 23:36:32.577 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 23:36:32.577 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-31 23:36:32.577 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 23:36:46.407 +07:00 [INF] Removing 0 grants
2019-12-31 23:37:17.038 +07:00 [INF] Removing 0 grants
2019-12-31 23:37:42.114 +07:00 [DBG] Start authorize request protocol validation
2019-12-31 23:37:42.114 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 23:37:42.114 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-31 23:37:42.760 +07:00 [DBG] Augmenting SignInContext
2019-12-31 23:37:42.763 +07:00 [DBG] Adding idp claim with value: local
2019-12-31 23:37:42.763 +07:00 [DBG] Adding amr claim with value: pwd
2019-12-31 23:37:42.777 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 23:37:42.789 +07:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2019-12-31 23:37:42.790 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2019-12-31 23:37:42.790 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2019-12-31 23:37:42.796 +07:00 [DBG] Start authorize callback request
2019-12-31 23:37:42.800 +07:00 [DBG] User in authorize request: 723f57d1-8ffb-4695-8fc0-99f00e0eff52
2019-12-31 23:37:42.800 +07:00 [DBG] Start authorize request protocol validation
2019-12-31 23:37:42.800 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 23:37:42.800 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-31 23:37:42.801 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"723f57d1-8ffb-4695-8fc0-99f00e0eff52","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"ffdda0f863fc408ca1b09c11bfc66f2c","UiLocales":null,"Nonce":"429a72007739418d8efc578286559369","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"9b113c0e79b2bbafb8cbba3b46aeab1d","Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"ffdda0f863fc408ca1b09c11bfc66f2c","nonce":"429a72007739418d8efc578286559369"},"$type":"AuthorizeRequestValidationLog"}
2019-12-31 23:37:43.447 +07:00 [DBG] Client is configured to not require consent, no consent is required
2019-12-31 23:37:43.455 +07:00 [DBG] Creating Implicit Flow response.
2019-12-31 23:37:43.465 +07:00 [DBG] Getting claims for access token for client: angular_spa
2019-12-31 23:37:43.465 +07:00 [DBG] Getting claims for access token for subject: 723f57d1-8ffb-4695-8fc0-99f00e0eff52
2019-12-31 23:37:44.929 +07:00 [DBG] Getting claims for identity token for subject: 723f57d1-8ffb-4695-8fc0-99f00e0eff52 and client: angular_spa
2019-12-31 23:37:44.929 +07:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-12-31 23:37:44.952 +07:00 [INF] Authorize endpoint response
{"SubjectId":"723f57d1-8ffb-4695-8fc0-99f00e0eff52","ClientId":"angular_spa","RedirectUri":"http://localhost:4200/auth-callback","State":"ffdda0f863fc408ca1b09c11bfc66f2c","Scope":"openid profile email api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-12-31 23:37:44.973 +07:00 [DBG] Augmenting SignInContext
2019-12-31 23:37:47.659 +07:00 [INF] Removing 0 grants
2019-12-31 23:37:48.223 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-31 23:37:48.223 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-31 23:37:48.223 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-31 23:37:48.224 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-31 23:37:48.225 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-31 23:37:48.225 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-31 23:37:48.225 +07:00 [DBG] Start discovery request
2019-12-31 23:37:48.248 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-12-31 23:37:48.248 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-31 23:37:48.248 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-31 23:37:48.248 +07:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-12-31 23:37:48.249 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-12-31 23:37:48.249 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-12-31 23:37:48.255 +07:00 [DBG] Start key discovery request
2019-12-31 23:37:48.304 +07:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-12-31 23:37:48.305 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-31 23:37:48.305 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-31 23:37:48.307 +07:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-12-31 23:37:48.309 +07:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-12-31 23:37:48.309 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-12-31 23:37:48.318 +07:00 [DBG] Start userinfo request
2019-12-31 23:37:48.323 +07:00 [DBG] Bearer token found in header
2019-12-31 23:37:48.350 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 23:37:48.353 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 23:37:48.968 +07:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-12-31 23:37:48.970 +07:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1577810264,"exp":1577813864,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourceapi"],"client_id":"angular_spa","sub":"723f57d1-8ffb-4695-8fc0-99f00e0eff52","auth_time":1577810262,"idp":"local","given_name":"Duy Chu","email":"duychusy92@gmail.com","http://schemas.microsoft.com/ws/2008/06/identity/claims/role":"consumer","scope":["openid","profile","email","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-12-31 23:37:48.981 +07:00 [DBG] Creating userinfo response
2019-12-31 23:37:48.984 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-31 23:37:48.986 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-31 23:37:48.988 +07:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-12-31 23:37:48.988 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-31 23:37:50.217 +07:00 [INF] Profile service returned the following claim types: sub preferred_username name email email_verified given_name email http://schemas.microsoft.com/ws/2008/06/identity/claims/role
2019-12-31 23:37:50.218 +07:00 [DBG] End userinfo request
2019-12-31 23:37:50.256 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-31 23:37:50.257 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-31 23:37:50.257 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-31 23:37:50.262 +07:00 [DBG] Rendering check session result
2019-12-31 23:38:18.279 +07:00 [INF] Removing 0 grants
2019-12-31 23:38:48.904 +07:00 [INF] Removing 0 grants
2019-12-31 23:39:19.540 +07:00 [INF] Removing 0 grants
2019-12-31 23:39:29.193 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-31 23:39:29.193 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-31 23:39:29.194 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-31 23:39:29.194 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-31 23:39:29.195 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-31 23:39:29.195 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-31 23:39:29.195 +07:00 [DBG] Start discovery request
2019-12-31 23:39:29.210 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2019-12-31 23:39:29.211 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2019-12-31 23:39:29.211 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2019-12-31 23:39:29.211 +07:00 [DBG] Start authorize request
2019-12-31 23:39:29.211 +07:00 [DBG] User in authorize request: 723f57d1-8ffb-4695-8fc0-99f00e0eff52
2019-12-31 23:39:29.211 +07:00 [DBG] Start authorize request protocol validation
2019-12-31 23:39:29.211 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 23:39:29.211 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2019-12-31 23:39:29.211 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"723f57d1-8ffb-4695-8fc0-99f00e0eff52","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"cadbd7003f7544d7bdc6549ccc66eadd","UiLocales":null,"Nonce":"704923aa5f9b4ed79bb06a9fffb319ce","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"9b113c0e79b2bbafb8cbba3b46aeab1d","Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"cadbd7003f7544d7bdc6549ccc66eadd","nonce":"704923aa5f9b4ed79bb06a9fffb319ce"},"$type":"AuthorizeRequestValidationLog"}
2019-12-31 23:39:29.850 +07:00 [DBG] Client is configured to not require consent, no consent is required
2019-12-31 23:39:29.850 +07:00 [DBG] Creating Implicit Flow response.
2019-12-31 23:39:29.850 +07:00 [DBG] Getting claims for access token for client: angular_spa
2019-12-31 23:39:29.850 +07:00 [DBG] Getting claims for access token for subject: 723f57d1-8ffb-4695-8fc0-99f00e0eff52
2019-12-31 23:39:31.080 +07:00 [DBG] Getting claims for identity token for subject: 723f57d1-8ffb-4695-8fc0-99f00e0eff52 and client: angular_spa
2019-12-31 23:39:31.080 +07:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2019-12-31 23:39:31.084 +07:00 [INF] Authorize endpoint response
{"SubjectId":"723f57d1-8ffb-4695-8fc0-99f00e0eff52","ClientId":"angular_spa","RedirectUri":"http://localhost:4200/auth-callback","State":"cadbd7003f7544d7bdc6549ccc66eadd","Scope":"openid profile email api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2019-12-31 23:39:31.673 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2019-12-31 23:39:31.673 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-31 23:39:31.673 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-31 23:39:31.673 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2019-12-31 23:39:31.686 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2019-12-31 23:39:31.686 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2019-12-31 23:39:31.686 +07:00 [DBG] Start discovery request
2019-12-31 23:39:31.754 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2019-12-31 23:39:31.754 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-31 23:39:31.754 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-31 23:39:31.755 +07:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2019-12-31 23:39:31.755 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2019-12-31 23:39:31.755 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2019-12-31 23:39:31.756 +07:00 [DBG] Start key discovery request
2019-12-31 23:39:31.837 +07:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2019-12-31 23:39:31.837 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2019-12-31 23:39:31.837 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2019-12-31 23:39:31.837 +07:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2019-12-31 23:39:31.837 +07:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2019-12-31 23:39:31.837 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2019-12-31 23:39:31.838 +07:00 [DBG] Start userinfo request
2019-12-31 23:39:31.838 +07:00 [DBG] Bearer token found in header
2019-12-31 23:39:31.841 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 23:39:31.841 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2019-12-31 23:39:32.459 +07:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2019-12-31 23:39:32.460 +07:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1577810371,"exp":1577813971,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourceapi"],"client_id":"angular_spa","sub":"723f57d1-8ffb-4695-8fc0-99f00e0eff52","auth_time":1577810262,"idp":"local","given_name":"Duy Chu","email":"duychusy92@gmail.com","http://schemas.microsoft.com/ws/2008/06/identity/claims/role":"consumer","scope":["openid","profile","email","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2019-12-31 23:39:32.460 +07:00 [DBG] Creating userinfo response
2019-12-31 23:39:32.460 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-31 23:39:32.460 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-31 23:39:32.460 +07:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2019-12-31 23:39:32.460 +07:00 [DBG] Scopes in access token: openid profile email api.read
2019-12-31 23:39:33.781 +07:00 [INF] Profile service returned the following claim types: sub preferred_username name email email_verified given_name email http://schemas.microsoft.com/ws/2008/06/identity/claims/role
2019-12-31 23:39:33.781 +07:00 [DBG] End userinfo request
2019-12-31 23:39:33.799 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2019-12-31 23:39:33.799 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2019-12-31 23:39:33.799 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2019-12-31 23:39:33.800 +07:00 [DBG] Rendering check session result
2019-12-31 23:39:50.165 +07:00 [INF] Removing 0 grants
2019-12-31 23:39:54.146 +07:00 [DBG] TaskCanceledException. Exiting.
2019-12-31 23:39:54.164 +07:00 [DBG] Stopping grant removal
2019-12-31 23:41:38.560 +07:00 [INF] Starting IdentityServer4 version 2.4.0.0
2019-12-31 23:41:38.749 +07:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2019-12-31 23:41:38.752 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2019-12-31 23:41:38.754 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2019-12-31 23:41:38.755 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2019-12-31 23:41:38.757 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2019-12-31 23:41:38.758 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2019-12-31 23:41:39.019 +07:00 [DBG] Starting grant removal
2019-12-31 23:42:12.037 +07:00 [INF] Removing 0 grants
2019-12-31 23:42:15.692 +07:00 [WRN] Failed to determine the https port for redirect.
2019-12-31 23:42:15.705 +07:00 [DBG] CORS request made for path: /api/account from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2019-12-31 23:42:15.720 +07:00 [DBG] Login Url: /Account/Login
2019-12-31 23:42:15.721 +07:00 [DBG] Login Return Url Parameter: ReturnUrl
2019-12-31 23:42:15.722 +07:00 [DBG] Logout Url: /Account/Logout
2019-12-31 23:42:15.723 +07:00 [DBG] ConsentUrl Url: /consent
2019-12-31 23:42:15.725 +07:00 [DBG] Consent Return Url Parameter: returnUrl
2019-12-31 23:42:15.726 +07:00 [DBG] Error Url: /home/error
2019-12-31 23:42:15.729 +07:00 [DBG] Error Id Parameter: errorId
2019-12-31 23:42:54.466 +07:00 [INF] Removing 0 grants
2019-12-31 23:42:56.324 +07:00 [ERR] Failed executing DbCommand (213ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `AspNetUserClaims` (`ClaimType`, `ClaimValue`, `UserId`)
VALUES (@p0, @p1, @p2);
SELECT `Id`
FROM `AspNetUserClaims`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
MySql.Data.MySqlClient.MySqlException (0x80004005): Field 'Id' doesn't have a default value ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Field 'Id' doesn't have a default value
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
2019-12-31 23:42:56.552 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'AuthServer.Infrastructure.Data.Identity.AppIdentityDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   --- End of inner exception stack trace ---
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   --- End of inner exception stack trace ---
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2019-12-31 23:42:56.814 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   --- End of inner exception stack trace ---
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore`9.UpdateAsync(TUser user, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Identity.UserManager`1.UpdateUserAsync(TUser user)
   at Microsoft.AspNetCore.Identity.UserManager`1.AddClaimsAsync(TUser user, IEnumerable`1 claims)
   at AuthServer.Controllers.AccountController.Register(RegisterRequestViewModel model) in D:\MyGitHub\sso-server\Controllers\AccountController.cs:line 170
   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at System.Threading.Tasks.ValueTask`1.get_Result()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Routing.EndpointRoutingMiddleware.Invoke(HttpContext httpContext)
   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\IdentityServerMiddleware.cs:line 72
   at IdentityServer4.Hosting.MutualTlsTokenEndpointMiddleware.Invoke(HttpContext context, IAuthenticationSchemeProvider schemes) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\MtlsTokenEndpointMiddleware.cs:line 60
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\src\Hosting\BaseUrlMiddleware.cs:line 36
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.InvokeCore(HttpContext context)
   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.Invoke(HttpContext context)
2019-12-31 23:43:25.112 +07:00 [INF] Removing 0 grants
2019-12-31 23:43:55.754 +07:00 [INF] Removing 0 grants
2019-12-31 23:44:26.403 +07:00 [INF] Removing 0 grants
2019-12-31 23:44:57.040 +07:00 [INF] Removing 0 grants
2019-12-31 23:45:27.679 +07:00 [INF] Removing 0 grants
2019-12-31 23:45:58.320 +07:00 [INF] Removing 0 grants
2019-12-31 23:46:28.973 +07:00 [INF] Removing 0 grants
2020-01-01 00:21:52.981 +07:00 [INF] Starting IdentityServer4 version 2.4.0.0
2020-01-01 00:21:53.168 +07:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-01-01 00:21:53.169 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-01-01 00:21:53.169 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-01-01 00:21:53.169 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-01-01 00:21:53.169 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-01-01 00:21:53.169 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-01-01 00:21:53.313 +07:00 [DBG] Starting grant removal
2020-01-01 00:22:26.296 +07:00 [INF] Removing 0 grants
2020-01-01 00:22:31.795 +07:00 [WRN] Failed to determine the https port for redirect.
2020-01-01 00:22:31.814 +07:00 [DBG] Login Url: /Account/Login
2020-01-01 00:22:31.814 +07:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-01-01 00:22:31.814 +07:00 [DBG] Logout Url: /Account/Logout
2020-01-01 00:22:31.814 +07:00 [DBG] ConsentUrl Url: /consent
2020-01-01 00:22:31.814 +07:00 [DBG] Consent Return Url Parameter: returnUrl
2020-01-01 00:22:31.814 +07:00 [DBG] Error Url: /home/error
2020-01-01 00:22:31.814 +07:00 [DBG] Error Id Parameter: errorId
2020-01-01 00:22:56.983 +07:00 [INF] Removing 0 grants
2020-01-01 00:23:27.627 +07:00 [INF] Removing 0 grants
2020-01-01 00:23:28.962 +07:00 [DBG] TaskCanceledException. Exiting.
2020-01-01 00:23:28.981 +07:00 [DBG] Stopping grant removal
2020-01-01 00:30:42.252 +07:00 [INF] Starting IdentityServer4 version 2.4.0.0
2020-01-01 00:30:42.369 +07:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-01-01 00:30:42.369 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-01-01 00:30:42.369 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-01-01 00:30:42.369 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-01-01 00:30:42.369 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-01-01 00:30:42.369 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-01-01 00:30:42.510 +07:00 [DBG] Starting grant removal
2020-01-01 00:31:15.397 +07:00 [INF] Removing 0 grants
2020-01-01 00:31:17.026 +07:00 [DBG] TaskCanceledException. Exiting.
2020-01-01 00:31:17.038 +07:00 [DBG] Stopping grant removal
2020-01-01 00:31:20.404 +07:00 [INF] Starting IdentityServer4 version 2.4.0.0
2020-01-01 00:31:20.521 +07:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-01-01 00:31:20.522 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-01-01 00:31:20.522 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-01-01 00:31:20.522 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-01-01 00:31:20.522 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-01-01 00:31:20.522 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-01-01 00:31:20.666 +07:00 [DBG] Starting grant removal
2020-01-01 00:31:29.179 +07:00 [DBG] TaskCanceledException. Exiting.
2020-01-01 00:31:29.192 +07:00 [DBG] Stopping grant removal
2020-01-01 00:31:32.031 +07:00 [INF] Starting IdentityServer4 version 2.4.0.0
2020-01-01 00:31:32.140 +07:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-01-01 00:31:32.141 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-01-01 00:31:32.141 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-01-01 00:31:32.141 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-01-01 00:31:32.141 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-01-01 00:31:32.141 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-01-01 00:31:32.285 +07:00 [DBG] Starting grant removal
2020-01-01 00:32:05.188 +07:00 [INF] Removing 0 grants
2020-01-01 00:32:19.290 +07:00 [DBG] TaskCanceledException. Exiting.
2020-01-01 00:32:19.302 +07:00 [DBG] Stopping grant removal
2020-01-01 00:32:28.051 +07:00 [INF] Starting IdentityServer4 version 2.4.0.0
2020-01-01 00:32:28.264 +07:00 [INF] Using the default authentication scheme Identity.Application for IdentityServer
2020-01-01 00:32:28.268 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for authentication
2020-01-01 00:32:28.271 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-in
2020-01-01 00:32:28.275 +07:00 [DBG] Using Identity.External as default ASP.NET Core scheme for sign-out
2020-01-01 00:32:28.277 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for challenge
2020-01-01 00:32:28.280 +07:00 [DBG] Using Identity.Application as default ASP.NET Core scheme for forbid
2020-01-01 00:32:28.533 +07:00 [DBG] Starting grant removal
2020-01-01 00:33:01.592 +07:00 [INF] Removing 0 grants
2020-01-01 00:33:32.242 +07:00 [INF] Removing 0 grants
2020-01-01 00:34:02.884 +07:00 [INF] Removing 0 grants
2020-01-01 00:34:33.526 +07:00 [INF] Removing 0 grants
2020-01-01 00:34:53.844 +07:00 [WRN] Failed to determine the https port for redirect.
2020-01-01 00:34:53.858 +07:00 [DBG] CORS request made for path: /api/account from origin: http://localhost:4200 but was ignored because path was not for an allowed IdentityServer CORS endpoint
2020-01-01 00:34:53.873 +07:00 [DBG] Login Url: /Account/Login
2020-01-01 00:34:53.874 +07:00 [DBG] Login Return Url Parameter: ReturnUrl
2020-01-01 00:34:53.876 +07:00 [DBG] Logout Url: /Account/Logout
2020-01-01 00:34:53.877 +07:00 [DBG] ConsentUrl Url: /consent
2020-01-01 00:34:53.878 +07:00 [DBG] Consent Return Url Parameter: returnUrl
2020-01-01 00:34:53.879 +07:00 [DBG] Error Url: /home/error
2020-01-01 00:34:53.881 +07:00 [DBG] Error Id Parameter: errorId
2020-01-01 00:35:06.727 +07:00 [INF] Removing 0 grants
2020-01-01 00:35:08.943 +07:00 [ERR] Failed executing DbCommand (205ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO `AspNetUserClaims` (`ClaimType`, `ClaimValue`, `UserId`)
VALUES (@p0, @p1, @p2);
SELECT `Id`
FROM `AspNetUserClaims`
WHERE ROW_COUNT() = 1 AND `Id` = LAST_INSERT_ID();
MySql.Data.MySqlClient.MySqlException (0x80004005): Field 'Id' doesn't have a default value ---> MySql.Data.MySqlClient.MySqlException (0x80004005): Field 'Id' doesn't have a default value
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
2020-01-01 00:35:09.170 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'AuthServer.Infrastructure.Data.Identity.AppIdentityDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   --- End of inner exception stack trace ---
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details. ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value ---> MySql.Data.MySqlClient.MySqlException: Field 'Id' doesn't have a default value
   at MySqlConnector.Core.ServerSession.TryAsyncContinuation(Task`1 task) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ServerSession.cs:line 1245
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)
--- End of stack trace from previous location where exception was thrown ---
   at MySqlConnector.Core.ResultSet.ReadResultSetHeaderAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\Core\ResultSet.cs:line 42
   --- End of inner exception stack trace ---
   at MySql.Data.MySqlClient.MySqlDataReader.ActivateResultSet(ResultSet resultSet) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 74
   at MySql.Data.MySqlClient.MySqlDataReader.ReadFirstResultSetAsync(IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 299
   at MySql.Data.MySqlClient.MySqlDataReader.CreateAsync(MySqlCommand command, CommandBehavior behavior, ResultSetProtocol resultSetProtocol, IOBehavior ioBehavior) in C:\projects\mysqlconnector\src\MySqlConnector\MySql.Data.MySqlClient\MySqlDataReader.cs:line 284
   at MySqlConnector.Core.TextCommandExecutor.ExecuteReaderAsync(String commandText, MySqlParameterCollection parameterCollection, CommandBehavior behavior, IOBehavior ioBehavior, CancellationToken cancellationToken) in C:\projects\mysqlconnector\src\MySqlConnector\Core\TextCommandExecutor.cs:line 37
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteAsync(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(DbContext _, ValueTuple`2 parameters, CancellationToken cancellationToken)
   at Pomelo.EntityFrameworkCore.MySql.Storage.Internal.MySqlExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IReadOnlyList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2020-01-01 00:35:27.759 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2020-01-01 00:35:27.767 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2020-01-01 00:35:27.768 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2020-01-01 00:35:27.773 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-01-01 00:35:27.780 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-01-01 00:35:27.781 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-01-01 00:35:27.786 +07:00 [DBG] Start discovery request
2020-01-01 00:35:27.849 +07:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2020-01-01 00:35:27.854 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2020-01-01 00:35:27.855 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2020-01-01 00:35:27.860 +07:00 [DBG] Start authorize request
2020-01-01 00:35:27.870 +07:00 [DBG] No user present in authorize request
2020-01-01 00:35:27.876 +07:00 [DBG] Start authorize request protocol validation
2020-01-01 00:35:27.897 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2020-01-01 00:35:27.937 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-01-01 00:35:27.959 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"anonymous","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"eb86ce8c70624084a6330476ccbca7f2","UiLocales":null,"Nonce":"9299400da63b43aab91a1b5790a7f7d5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":null,"Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"eb86ce8c70624084a6330476ccbca7f2","nonce":"9299400da63b43aab91a1b5790a7f7d5"},"$type":"AuthorizeRequestValidationLog"}
2020-01-01 00:35:27.969 +07:00 [INF] Showing login: User is not authenticated
2020-01-01 00:35:28.006 +07:00 [DBG] Start authorize request protocol validation
2020-01-01 00:35:28.007 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2020-01-01 00:35:28.009 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-01-01 00:35:28.014 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2020-01-01 00:35:37.347 +07:00 [INF] Removing 0 grants
2020-01-01 00:35:38.160 +07:00 [DBG] Start authorize request protocol validation
2020-01-01 00:35:38.162 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2020-01-01 00:35:38.163 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-01-01 00:35:38.788 +07:00 [DBG] Start authorize request protocol validation
2020-01-01 00:35:38.790 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2020-01-01 00:35:38.792 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-01-01 00:35:38.794 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2020-01-01 00:35:49.405 +07:00 [DBG] Start authorize request protocol validation
2020-01-01 00:35:49.407 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2020-01-01 00:35:49.408 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-01-01 00:35:50.054 +07:00 [DBG] Augmenting SignInContext
2020-01-01 00:35:50.058 +07:00 [DBG] Adding idp claim with value: local
2020-01-01 00:35:50.059 +07:00 [DBG] Adding amr claim with value: pwd
2020-01-01 00:35:50.078 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2020-01-01 00:35:50.097 +07:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2020-01-01 00:35:50.100 +07:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2020-01-01 00:35:50.101 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2020-01-01 00:35:50.108 +07:00 [DBG] Start authorize callback request
2020-01-01 00:35:50.113 +07:00 [DBG] User in authorize request: b7e4c206-b010-40c9-94b8-3c905cfdab0b
2020-01-01 00:35:50.115 +07:00 [DBG] Start authorize request protocol validation
2020-01-01 00:35:50.117 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2020-01-01 00:35:50.119 +07:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2020-01-01 00:35:50.120 +07:00 [INF] ValidatedAuthorizeRequest
{"ClientId":"angular_spa","ClientName":"Angular SPA","RedirectUri":"http://localhost:4200/auth-callback","AllowedRedirectUris":["http://localhost:4200/auth-callback"],"SubjectId":"b7e4c206-b010-40c9-94b8-3c905cfdab0b","ResponseType":"id_token token","ResponseMode":"fragment","GrantType":"implicit","RequestedScopes":"openid profile email api.read","State":"eb86ce8c70624084a6330476ccbca7f2","UiLocales":null,"Nonce":"9299400da63b43aab91a1b5790a7f7d5","AuthenticationContextReferenceClasses":null,"DisplayMode":null,"PromptMode":null,"MaxAge":null,"LoginHint":null,"SessionId":"a0df1a0050524410f731eb23c13d9306","Raw":{"client_id":"angular_spa","redirect_uri":"http://localhost:4200/auth-callback","response_type":"id_token token","scope":"openid profile email api.read","state":"eb86ce8c70624084a6330476ccbca7f2","nonce":"9299400da63b43aab91a1b5790a7f7d5"},"$type":"AuthorizeRequestValidationLog"}
2020-01-01 00:35:50.781 +07:00 [DBG] Client is configured to not require consent, no consent is required
2020-01-01 00:35:50.813 +07:00 [DBG] Creating Implicit Flow response.
2020-01-01 00:35:50.826 +07:00 [DBG] Getting claims for access token for client: angular_spa
2020-01-01 00:35:50.827 +07:00 [DBG] Getting claims for access token for subject: b7e4c206-b010-40c9-94b8-3c905cfdab0b
2020-01-01 00:35:52.253 +07:00 [DBG] Getting claims for identity token for subject: b7e4c206-b010-40c9-94b8-3c905cfdab0b and client: angular_spa
2020-01-01 00:35:52.255 +07:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2020-01-01 00:35:52.270 +07:00 [INF] Authorize endpoint response
{"SubjectId":"b7e4c206-b010-40c9-94b8-3c905cfdab0b","ClientId":"angular_spa","RedirectUri":"http://localhost:4200/auth-callback","State":"eb86ce8c70624084a6330476ccbca7f2","Scope":"openid profile email api.read","Error":null,"ErrorDescription":null,"$type":"AuthorizeResponseLog"}
2020-01-01 00:35:52.287 +07:00 [DBG] Augmenting SignInContext
2020-01-01 00:35:53.383 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration from origin: http://localhost:4200
2020-01-01 00:35:53.388 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2020-01-01 00:35:53.391 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2020-01-01 00:35:53.406 +07:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2020-01-01 00:35:53.423 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2020-01-01 00:35:53.432 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2020-01-01 00:35:53.447 +07:00 [DBG] Start discovery request
2020-01-01 00:35:53.477 +07:00 [DBG] CORS request made for path: /.well-known/openid-configuration/jwks from origin: http://localhost:4200
2020-01-01 00:35:53.489 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2020-01-01 00:35:53.491 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2020-01-01 00:35:53.495 +07:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2020-01-01 00:35:53.497 +07:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2020-01-01 00:35:53.500 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2020-01-01 00:35:53.509 +07:00 [DBG] Start key discovery request
2020-01-01 00:35:53.551 +07:00 [DBG] CORS request made for path: /connect/userinfo from origin: http://localhost:4200
2020-01-01 00:35:53.552 +07:00 [DBG] Client list checked and origin: http://localhost:4200 is allowed
2020-01-01 00:35:53.554 +07:00 [DBG] CorsPolicyService allowed origin: http://localhost:4200
2020-01-01 00:35:53.572 +07:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2020-01-01 00:35:53.575 +07:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2020-01-01 00:35:53.577 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2020-01-01 00:35:53.590 +07:00 [DBG] Start userinfo request
2020-01-01 00:35:53.594 +07:00 [DBG] Bearer token found in header
2020-01-01 00:35:53.619 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2020-01-01 00:35:53.623 +07:00 [DBG] client configuration validation for client angular_spa succeeded.
2020-01-01 00:35:54.243 +07:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2020-01-01 00:35:54.248 +07:00 [DBG] Token validation success
{"ClientId":null,"ClientName":null,"ValidateLifetime":true,"AccessTokenType":"Jwt","ExpectedScope":"openid","TokenHandle":null,"JwtId":null,"Claims":{"nbf":1577813752,"exp":1577817352,"iss":"http://localhost:5000","aud":["http://localhost:5000/resources","resourceapi"],"client_id":"angular_spa","sub":"b7e4c206-b010-40c9-94b8-3c905cfdab0b","auth_time":1577813750,"idp":"local","given_name":"Phuong","email":"phuong@outlook.com","http://schemas.microsoft.com/ws/2008/06/identity/claims/role":"consumer","scope":["openid","profile","email","api.read"],"amr":"pwd"},"$type":"TokenValidationLog"}
2020-01-01 00:35:54.257 +07:00 [DBG] Creating userinfo response
2020-01-01 00:35:54.261 +07:00 [DBG] Scopes in access token: openid profile email api.read
2020-01-01 00:35:54.265 +07:00 [DBG] Scopes in access token: openid profile email api.read
2020-01-01 00:35:54.269 +07:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at email email_verified
2020-01-01 00:35:54.270 +07:00 [DBG] Scopes in access token: openid profile email api.read
2020-01-01 00:35:55.493 +07:00 [INF] Profile service returned the following claim types: sub preferred_username name email email_verified given_name email http://schemas.microsoft.com/ws/2008/06/identity/claims/role
2020-01-01 00:35:55.496 +07:00 [DBG] End userinfo request
2020-01-01 00:35:55.524 +07:00 [DBG] Request path /connect/checksession matched to endpoint type Checksession
2020-01-01 00:35:55.528 +07:00 [DBG] Endpoint enabled: Checksession, successfully created handler: IdentityServer4.Endpoints.CheckSessionEndpoint
2020-01-01 00:35:55.547 +07:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.CheckSessionEndpoint for /connect/checksession
2020-01-01 00:35:55.553 +07:00 [DBG] Rendering check session result
2020-01-01 00:36:07.971 +07:00 [INF] Removing 0 grants
